<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Gene Expression Omnibus | The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research</title>
  <meta name="description" content="3.2 Gene Expression Omnibus | The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Gene Expression Omnibus | The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Gene Expression Omnibus | The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research" />
  
  
  

<meta name="author" content="Kyle Roell, Lauren Koval, Rebecca Boyles, Grace Patlewicz, Caroline Ring, Cynthia Rider, Cavin Ward-Caviness, David M. Reif, Ilona Jaspers, Rebecca C. Fry, and Julia E. Rager" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/Favicon_v1.png" type="image/x-icon" />
<link rel="prev" href="comparative-toxicogenomics-database.html"/>
<link rel="next" href="database-integration-air-quality-study-mortality-and-environmental-justice-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/Data Training Icon for Top Left Bookdown_v2.png"><br></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>Chapter 1 Introductory <br>Data Science</b></span></li>
<li class="chapter" data-level="" data-path="introduction-to-coding-in-r.html"><a href="introduction-to-coding-in-r.html"><i class="fa fa-check"></i>1.1 Introduction to Coding in R</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-coding-in-r.html"><a href="introduction-to-coding-in-r.html#introduction-to-training-module"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="introduction-to-coding-in-r.html"><a href="introduction-to-coding-in-r.html#r-packages"><i class="fa fa-check"></i>R Packages</a></li>
<li class="chapter" data-level="" data-path="introduction-to-coding-in-r.html"><a href="introduction-to-coding-in-r.html#scripting-basics"><i class="fa fa-check"></i>Scripting Basics</a></li>
<li class="chapter" data-level="" data-path="introduction-to-coding-in-r.html"><a href="introduction-to-coding-in-r.html#concluding-remarks-1"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-organization-basics.html"><a href="data-organization-basics.html"><i class="fa fa-check"></i>1.2 Data Organization Basics</a><ul>
<li class="chapter" data-level="" data-path="data-organization-basics.html"><a href="data-organization-basics.html#introduction-to-training-module-1"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-organization-basics.html"><a href="data-organization-basics.html#data-manipulation-using-base-r"><i class="fa fa-check"></i>Data Manipulation using Base R</a></li>
<li class="chapter" data-level="" data-path="data-organization-basics.html"><a href="data-organization-basics.html#introduction-to-tidyverse"><i class="fa fa-check"></i>Introduction to Tidyverse</a></li>
<li class="chapter" data-level="" data-path="data-organization-basics.html"><a href="data-organization-basics.html#concluding-remarks-2"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="finding-and-visualizing-data-trends.html"><a href="finding-and-visualizing-data-trends.html"><i class="fa fa-check"></i>1.3 Finding and Visualizing Data Trends</a><ul>
<li class="chapter" data-level="" data-path="finding-and-visualizing-data-trends.html"><a href="finding-and-visualizing-data-trends.html#introduction-to-training-module-2"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="finding-and-visualizing-data-trends.html"><a href="finding-and-visualizing-data-trends.html#basic-data-anaylsis"><i class="fa fa-check"></i>Basic Data Anaylsis</a></li>
<li class="chapter" data-level="" data-path="finding-and-visualizing-data-trends.html"><a href="finding-and-visualizing-data-trends.html#regression-modeling"><i class="fa fa-check"></i>Regression Modeling</a></li>
<li class="chapter" data-level="" data-path="finding-and-visualizing-data-trends.html"><a href="finding-and-visualizing-data-trends.html#categorical-data-analysis"><i class="fa fa-check"></i>Categorical Data Analysis</a></li>
<li class="chapter" data-level="" data-path="finding-and-visualizing-data-trends.html"><a href="finding-and-visualizing-data-trends.html#concluding-remarks-3"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html"><i class="fa fa-check"></i>1.4 High-Dimensional Data Visualizations</a><ul>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html#introduction-to-training-module-3"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html#high-dimensional-data-visualizations-1"><i class="fa fa-check"></i>High-Dimensional Data Visualizations</a></li>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html#density-plot-visualizations"><i class="fa fa-check"></i>Density Plot Visualizations</a></li>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html#ggally-visualizations"><i class="fa fa-check"></i>GGally Visualizations</a></li>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html#boxplot-visualizations"><i class="fa fa-check"></i>Boxplot Visualizations</a></li>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html#correlation-plot-visualizations"><i class="fa fa-check"></i>Correlation Plot Visualizations</a></li>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html#hierarchical-clustering-visualizations"><i class="fa fa-check"></i>Hierarchical Clustering Visualizations</a><ul>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html#heatmap-visualizations"><i class="fa fa-check"></i>Heatmap Visualizations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="high-dimensional-data-visualizations.html"><a href="high-dimensional-data-visualizations.html#concluding-remarks-4"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html"><i class="fa fa-check"></i>1.5 FAIR Data Management Practices</a><ul>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#introduction-to-training-module-4"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#introduction-to-fair"><i class="fa fa-check"></i>Introduction to FAIR</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#breaking-down-fair-letter-by-letter"><i class="fa fa-check"></i>Breaking Down FAIR, Letter-by-Letter</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#data-repositories-for-sharing-of-data"><i class="fa fa-check"></i>Data Repositories for Sharing of Data</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#helpful-resources-on-fair"><i class="fa fa-check"></i>Helpful Resources on FAIR</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#concluding-remarks-5"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="part"><span><b>Chapter 2 Chemical-<br>Biological Analyses <br>and Predictive Modeling</b></span></li>
<li class="chapter" data-level="" data-path="dose-response-modeling.html"><a href="dose-response-modeling.html"><i class="fa fa-check"></i>2.1 Dose-Response Modeling</a><ul>
<li class="chapter" data-level="" data-path="dose-response-modeling.html"><a href="dose-response-modeling.html#introduction-to-training-module-5"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="dose-response-modeling.html"><a href="dose-response-modeling.html#plotting-data-in-dose-response"><i class="fa fa-check"></i>Plotting Data in Dose-Response</a></li>
<li class="chapter" data-level="" data-path="dose-response-modeling.html"><a href="dose-response-modeling.html#dose-response-curve-fitting"><i class="fa fa-check"></i>Dose-Response Curve Fitting</a></li>
<li class="chapter" data-level="" data-path="dose-response-modeling.html"><a href="dose-response-modeling.html#comparing-curve-fits"><i class="fa fa-check"></i>Comparing Curve Fits</a></li>
<li class="chapter" data-level="" data-path="dose-response-modeling.html"><a href="dose-response-modeling.html#curve-fitting-example"><i class="fa fa-check"></i>Curve Fitting Example</a></li>
<li class="chapter" data-level="" data-path="dose-response-modeling.html"><a href="dose-response-modeling.html#deriving-benchmark-dose"><i class="fa fa-check"></i>Deriving Benchmark Dose</a></li>
<li class="chapter" data-level="" data-path="dose-response-modeling.html"><a href="dose-response-modeling.html#concluding-remarks-6"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="machine-learning-and-predictive-modeling-for-environmental-health.html"><a href="machine-learning-and-predictive-modeling-for-environmental-health.html"><i class="fa fa-check"></i>2.2 Machine Learning and Predictive Modeling for Environmental Health</a><ul>
<li class="chapter" data-level="" data-path="machine-learning-and-predictive-modeling-for-environmental-health.html"><a href="machine-learning-and-predictive-modeling-for-environmental-health.html#introduction-to-training-module-6"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="machine-learning-and-predictive-modeling-for-environmental-health.html"><a href="machine-learning-and-predictive-modeling-for-environmental-health.html#k-means-analysis"><i class="fa fa-check"></i>K-means Analysis</a></li>
<li class="chapter" data-level="" data-path="machine-learning-and-predictive-modeling-for-environmental-health.html"><a href="machine-learning-and-predictive-modeling-for-environmental-health.html#principal-component-analysis"><i class="fa fa-check"></i>Principal Component Analysis</a></li>
<li class="chapter" data-level="" data-path="machine-learning-and-predictive-modeling-for-environmental-health.html"><a href="machine-learning-and-predictive-modeling-for-environmental-health.html#combining-k-means-with-pca"><i class="fa fa-check"></i>Combining K-Means with PCA</a></li>
<li class="chapter" data-level="" data-path="machine-learning-and-predictive-modeling-for-environmental-health.html"><a href="machine-learning-and-predictive-modeling-for-environmental-health.html#concluding-remarks-7"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixtures-analysis.html"><a href="mixtures-analysis.html"><i class="fa fa-check"></i>2.3 Mixtures Analysis</a><ul>
<li class="chapter" data-level="" data-path="mixtures-analysis.html"><a href="mixtures-analysis.html#introduction-to-training-module-7"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="mixtures-analysis.html"><a href="mixtures-analysis.html#chemistry-based-approach"><i class="fa fa-check"></i>Chemistry-based Approach</a></li>
<li class="chapter" data-level="" data-path="mixtures-analysis.html"><a href="mixtures-analysis.html#toxicity-based-approach"><i class="fa fa-check"></i>Toxicity-based Approach</a></li>
<li class="chapter" data-level="" data-path="mixtures-analysis.html"><a href="mixtures-analysis.html#comparing-results"><i class="fa fa-check"></i>Comparing Results</a><ul>
<li class="chapter" data-level="" data-path="mixtures-analysis.html"><a href="mixtures-analysis.html#visual-representation-of-some-of-the-major-grouping-similarities-vs-differences"><i class="fa fa-check"></i>Visual representation of some of the major grouping similarities vs differences</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixtures-analysis.html"><a href="mixtures-analysis.html#concluding-remarks-8"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html"><i class="fa fa-check"></i>2.4 -Omics Analyses and Systems Biology</a><ul>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html#the-field-of--omics"><i class="fa fa-check"></i>The Field of “-Omics”</a></li>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html#transcriptomics"><i class="fa fa-check"></i>Transcriptomics</a></li>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html#introduction-to-training-module-8"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html#transcriptomics-data-qaqc"><i class="fa fa-check"></i>Transcriptomics Data QA/QC</a></li>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html#statistical-analysis-of-gene-expression"><i class="fa fa-check"></i>Statistical Analysis of Gene Expression</a></li>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html#ma-plots"><i class="fa fa-check"></i>MA Plots</a></li>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html#volcano-plots"><i class="fa fa-check"></i>Volcano Plots</a></li>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html#pathway-enrichment-analysis"><i class="fa fa-check"></i>Pathway Enrichment Analysis</a></li>
<li class="chapter" data-level="" data-path="omics-analyses-and-systems-biology.html"><a href="omics-analyses-and-systems-biology.html#concluding-remarks-9"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="toxicokinetic-modeling.html"><a href="toxicokinetic-modeling.html"><i class="fa fa-check"></i>2.5 Toxicokinetic Modeling</a></li>
<li class="chapter" data-level="" data-path="read-across-toxicity-predictions.html"><a href="read-across-toxicity-predictions.html"><i class="fa fa-check"></i>2.6 Read-Across Toxicity Predictions</a></li>
<li class="part"><span><b>Chapter 3 Environmental <br>Health Database Mining</b></span></li>
<li class="chapter" data-level="" data-path="comparative-toxicogenomics-database.html"><a href="comparative-toxicogenomics-database.html"><i class="fa fa-check"></i>3.1 Comparative Toxicogenomics Database</a><ul>
<li class="chapter" data-level="" data-path="comparative-toxicogenomics-database.html"><a href="comparative-toxicogenomics-database.html#introduction-to-training-module-9"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="comparative-toxicogenomics-database.html"><a href="comparative-toxicogenomics-database.html#ctd-data-in-r"><i class="fa fa-check"></i>CTD Data in R</a></li>
<li class="chapter" data-level="" data-path="comparative-toxicogenomics-database.html"><a href="comparative-toxicogenomics-database.html#identifying-genes-under-epigenetic-control"><i class="fa fa-check"></i>Identifying Genes under Epigenetic Control</a></li>
<li class="chapter" data-level="" data-path="comparative-toxicogenomics-database.html"><a href="comparative-toxicogenomics-database.html#concluding-remarks-10"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gene-expression-omnibus.html"><a href="gene-expression-omnibus.html"><i class="fa fa-check"></i>3.2 Gene Expression Omnibus</a><ul>
<li class="chapter" data-level="" data-path="gene-expression-omnibus.html"><a href="gene-expression-omnibus.html#introduction-to-training-module-10"><i class="fa fa-check"></i>Introduction to Training Module</a><ul>
<li><a href="gene-expression-omnibus.html#training-modules-environmental-health-questions-5">Training Module’s <strong>Environmental Health Questions</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gene-expression-omnibus.html"><a href="gene-expression-omnibus.html#geo-data-in-r"><i class="fa fa-check"></i>GEO Data in R</a></li>
<li class="chapter" data-level="" data-path="gene-expression-omnibus.html"><a href="gene-expression-omnibus.html#visualizing-data"><i class="fa fa-check"></i>Visualizing Data</a></li>
<li class="chapter" data-level="" data-path="gene-expression-omnibus.html"><a href="gene-expression-omnibus.html#statistical-analyses"><i class="fa fa-check"></i>Statistical Analyses</a></li>
<li class="chapter" data-level="" data-path="gene-expression-omnibus.html"><a href="gene-expression-omnibus.html#concluding-remarks-11"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="database-integration-air-quality-study-mortality-and-environmental-justice-data.html"><a href="database-integration-air-quality-study-mortality-and-environmental-justice-data.html"><i class="fa fa-check"></i>3.3 Database Integration: Air Quality Study, Mortality, and Environmental Justice Data</a></li>
<li class="part"><span><b>Additional Resources</b></span></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i>Resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="gene-expression-omnibus" class="section level1">
<h1>3.2 Gene Expression Omnibus</h1>
<p>This training module was developed by Dr. Kyle Roell and Dr. Julia E. Rager</p>
<p>Fall 2021</p>
<div id="background-on-training-module-1" class="section level4">
<h4>Background on Training Module</h4>
</div>
<div id="introduction-to-the-environmental-health-database-gene-expression-omnibus-geo" class="section level4">
<h4>Introduction to the Environmental Health Database, Gene Expression Omnibus (GEO)</h4>
<p><a href="https://www.ncbi.nlm.nih.gov/geo/">GEO</a> is a publicly available database repository of high-throughput gene expression data and hybridization arrays, chips, and microarrays that span genome-wide endpoints of genomics, transcriptomics, and epigenomics. The repository is organized and managed by the <a href="https://www.ncbi.nlm.nih.gov/">The National Center for Biotechnology Information (NCBI)</a>, which seeks to advance science and health by providing access to biomedical and genomic information. The three <a href="https://www.ncbi.nlm.nih.gov/geo/info/overview.html">overall goals</a> of GEO are to: (1) Provide a robust, versatile database in which to efficiently store high-throughput functional genomic data, (2) Offer simple submission procedures and formats that support complete and well-annotated data deposits from the research community, and (3) Provide user-friendly mechanisms that allow users to query, locate, review and download studies and gene expression profiles of interest.</p>
<p>Of high relevance to environmental health, data organized within GEO can be pulled and analyzed to address new environmental health questions, leveraging previously generated data. For example, we have pulled gene expression data from acute myeloid leukemia patients and re-analyzed these data to elucidate new mechanisms of epigenetically-regulated networks involved in cancer, that in turn, may be modified by environmental insults, as previously published in <a href="https://pubmed.ncbi.nlm.nih.gov/22754483/">Rager et al. 2012</a>. We have also pulled and analyzed gene expression data from published studies evaluating toxicity resulting from hexavalent chromium exposure, to further substantiate the role of epigenetic mediators in hexavelent chromium-induced carcinogenesis (see <a href="https://pubmed.ncbi.nlm.nih.gov/30690063/">Rager et al. 2019</a>). This training exercise leverages an additional dataset that we published and deposited through GEO to evaluate the effects of formaldehyde inhalation exposure, as detailed below.</p>
</div>
<div id="introduction-to-training-module-10" class="section level2">
<h2>Introduction to Training Module</h2>
<p>This training module provides an overview on pulling and analyzing data deposited in GEO. As an example, data are pulled from the published GEO dataset recorded through the online series <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42394">GSE42394</a>. This series representsAffymetrix rat genome-wide microarray data generated from our previous study, aimed at evaluating the transcriptomic effects of formaldehyde across three tissues: the nose, blood, and bone marrow. For the purposes of this training module, we will focus on evaluating gene expression profiles from nasal samples after 7 days of exposure, collected from rats exposed to 2 ppm formaldehyde via inhalation. These findings, in addition to other epigenomic endpoint measures, have been previously published (see <a href="https://pubmed.ncbi.nlm.nih.gov/24304932/">Rager et al. 2014</a>).</p>
<p>This training module specifically guides trainees through the loading of required packages and data, including the manual upload of GEO data as well as the upload/organization of data leveraging the <a href="https://www.bioconductor.org/packages/release/bioc/html/GEOquery.html">GEOquery package</a>. Data are then further organized and combined with gene annotation information through the merging of platform annotation files. Example visualizations are then produced, including boxplots to evaluate the overall distribution of expression data across samples, as well as heat map visualizations that compare unscaled versus scaled gene expression values. Statistical analyses are then included to identify which genes are significantly altered in expression upon exposure to formaldehyde. Together, this training module serves as a simple example showing methods to access and download GEO data and to perform data organization, analysis, and visualization tasks through applications-based questions.</p>
<div id="training-modules-environmental-health-questions-5" class="section level3">
<h3>Training Module’s <strong>Environmental Health Questions</strong></h3>
<p>This training module was specifically developed to answer the following environmental health questions:</p>
<ol style="list-style-type: decimal">
<li>What kind of molecular identifiers are commonly used in microarray-based -omics technologies?</li>
<li>How can we convert platform-specific molecular identifiers used in -omics study designs to gene-level information?</li>
<li>Why do we often scale gene expression signatures prior to heat map visualizations?</li>
<li>What genes are altered in expression by formaldehyde inhalation exposure?</li>
<li>What are the potential biological consequences of these gene-level perturbations?</li>
</ol>
<div id="script-preparations-7" class="section level4">
<h4>Script Preparations</h4>
</div>
<div id="cleaning-the-global-environment-7" class="section level4">
<h4>Cleaning the global environment</h4>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="gene-expression-omnibus.html#cb417-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span></code></pre></div>
</div>
<div id="installing-required-r-packages-7" class="section level4">
<h4>Installing required R packages</h4>
<p>If you already have these packages installed, you can skip this step, or you can run the below code which checks installation status for you</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="gene-expression-omnibus.html#cb418-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">&quot;tidyverse&quot;</span>))</span>
<span id="cb418-2"><a href="gene-expression-omnibus.html#cb418-2"></a>  <span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb418-3"><a href="gene-expression-omnibus.html#cb418-3"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">&quot;reshape2&quot;</span>))</span>
<span id="cb418-4"><a href="gene-expression-omnibus.html#cb418-4"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;reshape2&quot;</span>)</span>
<span id="cb418-5"><a href="gene-expression-omnibus.html#cb418-5"></a></span>
<span id="cb418-6"><a href="gene-expression-omnibus.html#cb418-6"></a><span class="co"># GEOquery, this will install BiocManager if you don&#39;t have it installed</span></span>
<span id="cb418-7"><a href="gene-expression-omnibus.html#cb418-7"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>))</span>
<span id="cb418-8"><a href="gene-expression-omnibus.html#cb418-8"></a>  <span class="kw">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)</span>
<span id="cb418-9"><a href="gene-expression-omnibus.html#cb418-9"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">&quot;GEOquery&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: package(s) not installed when version(s) same as current; use `force = TRUE` to
##   re-install: &#39;GEOquery&#39;</code></pre>
</div>
<div id="loading-r-packages-required-for-this-session-7" class="section level4">
<h4>Loading R packages required for this session</h4>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="gene-expression-omnibus.html#cb420-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb420-2"><a href="gene-expression-omnibus.html#cb420-2"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb420-3"><a href="gene-expression-omnibus.html#cb420-3"></a><span class="kw">library</span>(GEOquery)</span></code></pre></div>
<p>For more information on the <strong>tidyverse package</strong>, see its associated <a href="https://cran.r-project.org/web/packages/tidyverse/index.html">CRAN webpage</a>, primary <a href="https://www.tidyverse.org/packages/">webpage</a>, and peer-reviewed <a href="https://onlinelibrary.wiley.com/doi/10.1002/sdr.1600">article released in 2018</a>.</p>
<p>For more information on the <strong>reshape2 package</strong>, see its associated <a href="https://cran.r-project.org/web/packages/reshape2/index.html">CRAN webpage</a>, <a href="https://www.rdocumentation.org/packages/reshape2/versions/1.4.4">R Documentation</a>, and <a href="https://seananderson.ca/2013/10/19/reshape/">helpful website</a> providing an introduction to the reshape2 package.</p>
<p>For more information on the <strong>GEOquery package</strong>, see its associated <a href="https://www.bioconductor.org/packages/release/bioc/html/GEOquery.html">Bioconductor website</a> and <a href="https://www.rdocumentation.org/packages/GEOquery/versions/2.38.4">R Documentation file</a>.</p>
</div>
<div id="set-your-working-directory-9" class="section level4">
<h4>Set your working directory</h4>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="gene-expression-omnibus.html#cb421-1"></a><span class="kw">setwd</span>(<span class="st">&quot;/filepath to where your input files are&quot;</span>)</span></code></pre></div>
</div>
<div id="loading-and-organizing-the-example-dataset" class="section level4">
<h4>Loading and Organizing the Example Dataset</h4>
<p>Let’s start by loading the GEO dataset needed for this training module. As explained in the introduction, this module walks through two methods of uploading GEO data: manual option vs automatic option using the GEOquery package. These two methods are detailed below.</p>
</div>
</div>
</div>
<div id="geo-data-in-r" class="section level2">
<h2>GEO Data in R</h2>
<div id="manually-downloading-and-uploading-geo-files" class="section level4">
<h4>1. Manually Downloading and Uploading GEO Files</h4>
<p>In this first method, we will navigate to the datasets within the GEO website, manually download its associated text data file, save it in our working directory, and then upload it into our global environment in R.</p>
<p>For the purposes of this training exercise, we manually downloaded the GEO series matrix file from the GEO series webpage, located at: <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42394" class="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42394</a>. The specific file that was downloaded was noted as <em>GSE42394_series_matrix.txt</em>, pulled by clicking on the link indicated by the red arrow from the GEO series webpage:</p>
<p><img src="_book/TAME_Toolkit_files/figure-html/Module3_2_GEO_Screenshot1.png" width="506" /></p>
<p>For simplicity, we also have already pre-filtered this file for the samples we are interested in, focusing on the rat nasal gene expression data after 7 days of exposure to gaseous formaldehyde. This filtered file was saved as: <em>GSE42394_series_matrix_filtered.txt</em></p>
<p>At this point, we can simply read in this pre-filtered text file for the purposes of this training module</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="gene-expression-omnibus.html#cb422-1"></a>geodata_manual &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file=</span><span class="st">&quot;Module3_2/Module3_2_GSE42394_series_matrix_filtered.txt&quot;</span>,</span>
<span id="cb422-2"><a href="gene-expression-omnibus.html#cb422-2"></a>                             <span class="dt">header=</span>T)</span></code></pre></div>
<p>Because this is a manual approach, we have to also manually define the treated and untreated samples (based on manually opening the surrounding metadata from the GEO webpage)</p>
<p>Manually defining treated and untreated for these samples of interest:</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="gene-expression-omnibus.html#cb423-1"></a>exposed_manual &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;GSM1150940&quot;</span>, <span class="st">&quot;GSM1150941&quot;</span>, <span class="st">&quot;GSM1150942&quot;</span>)</span>
<span id="cb423-2"><a href="gene-expression-omnibus.html#cb423-2"></a>unexposed_manual &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;GSM1150937&quot;</span>, <span class="st">&quot;GSM1150938&quot;</span>, <span class="st">&quot;GSM1150939&quot;</span>)</span></code></pre></div>
</div>
<div id="uploading-and-organizing-geo-files-through-the-geoquery-package" class="section level4">
<h4>2. Uploading and Organizing GEO Files through the GEOquery Package</h4>
<p>In this second method, we will leverage the GEOquery package, which allows for easier downloading and reading in of data from GEO without having to manually download raw text files, and manually assign sample attributes (e.g., exposed vs unexposed). This package is set-up to automatically merge sample information from GEO metadata files with raw genome-wide datasets.</p>
<p>Let’s first use the getGEO function (from the GEOquery package) to load data from our series matrix
<em>Note that this line of code may take a couple of minutes</em></p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="gene-expression-omnibus.html#cb424-1"></a>geo.getGEO.data &lt;-<span class="st"> </span><span class="kw">getGEO</span>(<span class="dt">filename=</span><span class="st">&#39;Module3_2/Module3_2_GSE42394_series_matrix.txt&#39;</span>)</span></code></pre></div>
<p>One of the reasons the getGEO package so helpful is that we can automatically link a dataset with nicely organized sample information using the pData() function</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="gene-expression-omnibus.html#cb425-1"></a>sampleInfo &lt;-<span class="st"> </span><span class="kw">pData</span>(geo.getGEO.data)</span></code></pre></div>
<p>Let’s view this sample information / metadata file, first by viewing what the column headers are</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="gene-expression-omnibus.html#cb426-1"></a><span class="kw">colnames</span>(sampleInfo)</span></code></pre></div>
<pre><code>##  [1] &quot;title&quot;                   &quot;geo_accession&quot;          
##  [3] &quot;status&quot;                  &quot;submission_date&quot;        
##  [5] &quot;last_update_date&quot;        &quot;type&quot;                   
##  [7] &quot;channel_count&quot;           &quot;source_name_ch1&quot;        
##  [9] &quot;organism_ch1&quot;            &quot;characteristics_ch1&quot;    
## [11] &quot;characteristics_ch1.1&quot;   &quot;characteristics_ch1.2&quot;  
## [13] &quot;characteristics_ch1.3&quot;   &quot;characteristics_ch1.4&quot;  
## [15] &quot;characteristics_ch1.5&quot;   &quot;treatment_protocol_ch1&quot; 
## [17] &quot;growth_protocol_ch1&quot;     &quot;molecule_ch1&quot;           
## [19] &quot;extract_protocol_ch1&quot;    &quot;label_ch1&quot;              
## [21] &quot;label_protocol_ch1&quot;      &quot;taxid_ch1&quot;              
## [23] &quot;hyb_protocol&quot;            &quot;scan_protocol&quot;          
## [25] &quot;description&quot;             &quot;data_processing&quot;        
## [27] &quot;platform_id&quot;             &quot;contact_name&quot;           
## [29] &quot;contact_email&quot;           &quot;contact_department&quot;     
## [31] &quot;contact_institute&quot;       &quot;contact_address&quot;        
## [33] &quot;contact_city&quot;            &quot;contact_zip/postal_code&quot;
## [35] &quot;contact_country&quot;         &quot;supplementary_file&quot;     
## [37] &quot;data_row_count&quot;          &quot;age:ch1&quot;                
## [39] &quot;cell type:ch1&quot;           &quot;gender:ch1&quot;             
## [41] &quot;strain:ch1&quot;              &quot;time:ch1&quot;               
## [43] &quot;treatment:ch1&quot;</code></pre>
<p>Then viewing the first five columns</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="gene-expression-omnibus.html#cb428-1"></a>sampleInfo[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##                                                    title geo_accession
## GSM1150937            Nose_7DayControl_Rep1 [Affymetrix]    GSM1150937
## GSM1150938            Nose_7DayControl_Rep2 [Affymetrix]    GSM1150938
## GSM1150939            Nose_7DayControl_Rep3 [Affymetrix]    GSM1150939
## GSM1150940            Nose_7DayExposed_Rep1 [Affymetrix]    GSM1150940
## GSM1150941            Nose_7DayExposed_Rep2 [Affymetrix]    GSM1150941
## GSM1150942            Nose_7DayExposed_Rep3 [Affymetrix]    GSM1150942
## GSM1150943 WhiteBloodCells_7DayControl_Rep1 [Affymetrix]    GSM1150943
## GSM1150944 WhiteBloodCells_7DayControl_Rep2 [Affymetrix]    GSM1150944
## GSM1150945 WhiteBloodCells_7DayControl_Rep3 [Affymetrix]    GSM1150945
## GSM1150946 WhiteBloodCells_7DayExposed_Rep1 [Affymetrix]    GSM1150946
##                           status submission_date last_update_date
## GSM1150937 Public on Jan 07 2014     May 29 2013      Jan 07 2014
## GSM1150938 Public on Jan 07 2014     May 29 2013      Jan 07 2014
## GSM1150939 Public on Jan 07 2014     May 29 2013      Jan 07 2014
## GSM1150940 Public on Jan 07 2014     May 29 2013      Jan 07 2014
## GSM1150941 Public on Jan 07 2014     May 29 2013      Jan 07 2014
## GSM1150942 Public on Jan 07 2014     May 29 2013      Jan 07 2014
## GSM1150943 Public on Jan 07 2014     May 29 2013      Jan 07 2014
## GSM1150944 Public on Jan 07 2014     May 29 2013      Jan 07 2014
## GSM1150945 Public on Jan 07 2014     May 29 2013      Jan 07 2014
## GSM1150946 Public on Jan 07 2014     May 29 2013      Jan 07 2014</code></pre>
<p>This shows that each sample is provided with a unique number starting with “GSM”, and these are described by information summarized in the “title” column. We can also see that these data were made public on Jan 7, 2014.</p>
<p>Let’s view the next five columns</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="gene-expression-omnibus.html#cb430-1"></a>sampleInfo[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">6</span><span class="op">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##            type channel_count                                 source_name_ch1
## GSM1150937  RNA             1        Nasal epithelial cells, 7 day, unexposed
## GSM1150938  RNA             1        Nasal epithelial cells, 7 day, unexposed
## GSM1150939  RNA             1        Nasal epithelial cells, 7 day, unexposed
## GSM1150940  RNA             1          Nasal epithelial cells, 7 day, exposed
## GSM1150941  RNA             1          Nasal epithelial cells, 7 day, exposed
## GSM1150942  RNA             1          Nasal epithelial cells, 7 day, exposed
## GSM1150943  RNA             1 Circulating white blood cells, 7 day, unexposed
## GSM1150944  RNA             1 Circulating white blood cells, 7 day, unexposed
## GSM1150945  RNA             1 Circulating white blood cells, 7 day, unexposed
## GSM1150946  RNA             1   Circulating white blood cells, 7 day, exposed
##                 organism_ch1 characteristics_ch1
## GSM1150937 Rattus norvegicus        gender: male
## GSM1150938 Rattus norvegicus        gender: male
## GSM1150939 Rattus norvegicus        gender: male
## GSM1150940 Rattus norvegicus        gender: male
## GSM1150941 Rattus norvegicus        gender: male
## GSM1150942 Rattus norvegicus        gender: male
## GSM1150943 Rattus norvegicus        gender: male
## GSM1150944 Rattus norvegicus        gender: male
## GSM1150945 Rattus norvegicus        gender: male
## GSM1150946 Rattus norvegicus        gender: male</code></pre>
<p>We can see that information is provided here surrounding the type of sample that was analyzed (i.e., RNA), more information on the collected samples within the column ‘source_name_ch1’, and the organism (rat) is provided in the ‘organism_ch1’ column.</p>
<p>More detailed metadata information is provided throughout this file, as seen when viewing the column headers above</p>
</div>
<div id="now-we-can-use-this-information-to-define-the-samples-we-want-to-analyze." class="section level4">
<h4>Now, we can use this information to define the samples we want to analyze.</h4>
<p>Note that this is the same step we did manually above.</p>
<p>In this training exercise, we are focusing on responses in the nose, so we can easily filter for cell type = Nasal epithelial cells (specifically in the “cell type:ch1” variable)</p>
<p>We are also focusing on responses collected after 7 days of exposure, which we can filter for using time = 7 day (specifically in the “time:ch1” variable).</p>
<p>We will also define exposed and unexposed samples using the variable “treatment:ch1”.</p>
<p>First, let’s subset the sampleInfo dataframe to just keep the samples we’re interested in</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="gene-expression-omnibus.html#cb432-1"></a><span class="co"># Define a vector variable (here we call it &#39;keep&#39;) that will store rows we want to keep</span></span>
<span id="cb432-2"><a href="gene-expression-omnibus.html#cb432-2"></a>keep &lt;-<span class="st"> </span><span class="kw">rownames</span>(sampleInfo[<span class="kw">which</span>(sampleInfo<span class="op">$</span><span class="st">`</span><span class="dt">cell type:ch1</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;Nasal epithelial cells&quot;</span> </span>
<span id="cb432-3"><a href="gene-expression-omnibus.html#cb432-3"></a>                                  <span class="op">&amp;</span><span class="st"> </span>sampleInfo<span class="op">$</span><span class="st">`</span><span class="dt">time:ch1</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;7 day&quot;</span>),])</span>
<span id="cb432-4"><a href="gene-expression-omnibus.html#cb432-4"></a></span>
<span id="cb432-5"><a href="gene-expression-omnibus.html#cb432-5"></a><span class="co"># Then subset the sample info for just those samples we defined in keep variable</span></span>
<span id="cb432-6"><a href="gene-expression-omnibus.html#cb432-6"></a>sampleInfo &lt;-<span class="st"> </span>sampleInfo[keep,]</span></code></pre></div>
<p>Next, we can pull the exposed and unexposed animal IDs. Let’s first see how these are labeled within the “treatment:ch1” variable</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="gene-expression-omnibus.html#cb433-1"></a><span class="kw">unique</span>(sampleInfo<span class="op">$</span><span class="st">`</span><span class="dt">treatment:ch1</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## [1] &quot;unexposed&quot;          &quot;2 ppm formaldehyde&quot;</code></pre>
<p>And then search for the rows of data, pulling the sample animal IDs (which are in the variable ‘geo_accession’)</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="gene-expression-omnibus.html#cb435-1"></a>exposedIDs  &lt;-<span class="st"> </span>sampleInfo[<span class="kw">which</span>(sampleInfo<span class="op">$</span><span class="st">`</span><span class="dt">treatment:ch1</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;2 ppm formaldehyde&quot;</span>), </span>
<span id="cb435-2"><a href="gene-expression-omnibus.html#cb435-2"></a>                          <span class="st">&quot;geo_accession&quot;</span>]</span>
<span id="cb435-3"><a href="gene-expression-omnibus.html#cb435-3"></a>unexposedIDs  &lt;-<span class="st"> </span>sampleInfo[<span class="kw">which</span>(sampleInfo<span class="op">$</span><span class="st">`</span><span class="dt">treatment:ch1</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;unexposed&quot;</span>), </span>
<span id="cb435-4"><a href="gene-expression-omnibus.html#cb435-4"></a>                            <span class="st">&quot;geo_accession&quot;</span>]</span></code></pre></div>
</div>
<div id="the-next-step-is-to-pull-the-expression-data-we-want-to-use-in-our-analyses." class="section level4">
<h4>The next step is to pull the expression data we want to use in our analyses.</h4>
<p>The GEOquery function, exprs(), allows us to easily pull these data. Here, we can pull the data we’re interested in using the exprs() function, while defining the data we want to pull based off our previously generated ‘keep’ vector.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="gene-expression-omnibus.html#cb436-1"></a><span class="co"># As a reminder, this is what the &#39;keep&#39; vector includes </span></span>
<span id="cb436-2"><a href="gene-expression-omnibus.html#cb436-2"></a><span class="co"># (i.e., animal IDs that we&#39;re interested in)</span></span>
<span id="cb436-3"><a href="gene-expression-omnibus.html#cb436-3"></a>keep</span></code></pre></div>
<pre><code>## [1] &quot;GSM1150937&quot; &quot;GSM1150938&quot; &quot;GSM1150939&quot; &quot;GSM1150940&quot; &quot;GSM1150941&quot;
## [6] &quot;GSM1150942&quot;</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="gene-expression-omnibus.html#cb438-1"></a><span class="co">#Using the exprs() function</span></span>
<span id="cb438-2"><a href="gene-expression-omnibus.html#cb438-2"></a>geodata &lt;-<span class="st"> </span><span class="kw">exprs</span>(geo.getGEO.data[,keep])</span></code></pre></div>
<p>Let’s view the full dataset as is now</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="gene-expression-omnibus.html#cb439-1"></a><span class="kw">head</span>(geodata)</span></code></pre></div>
<pre><code>##          GSM1150937 GSM1150938 GSM1150939 GSM1150940 GSM1150941 GSM1150942
## 10700001    5786.60    5830.08    5637.34    5313.33    5557.04    5469.90
## 10700002     192.92     206.86     220.83     183.12     177.16     198.64
## 10700003    1820.98    1795.79    1735.70    1578.02    1681.58    1632.20
## 10700004      66.95      65.61      64.41      60.19      60.41      60.67
## 10700005     770.07     753.41     731.20     684.53     657.25     667.66
## 10700006       5.80       5.35       5.48       5.58       5.39       5.35</code></pre>
<p>This now represents a matrix of data, with animal IDs as column headers and expression levels within the matrix.</p>
</div>
<div id="simplifying-column-names" class="section level4">
<h4>Simplifying column names</h4>
<p>These column names are not the easiest to interpret, so let’s rename these columns to indicate which animals were from the exposed vs. unexposed groups.</p>
<p>We need to first convert our expression dataset to a dataframe so we can edit columns names, and continue with downstream data manipulations that require dataframe formats</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="gene-expression-omnibus.html#cb441-1"></a>geodata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(geodata)</span></code></pre></div>
<p>Let’s remind ourselves what the column names are</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="gene-expression-omnibus.html#cb442-1"></a><span class="kw">colnames</span>(geodata)</span></code></pre></div>
<pre><code>## [1] &quot;GSM1150937&quot; &quot;GSM1150938&quot; &quot;GSM1150939&quot; &quot;GSM1150940&quot; &quot;GSM1150941&quot;
## [6] &quot;GSM1150942&quot;</code></pre>
<p>Which ones of these are exposed vs unexposed animals can be determined by viewing our previously defined vectors</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="gene-expression-omnibus.html#cb444-1"></a>exposedIDs</span></code></pre></div>
<pre><code>## [1] &quot;GSM1150940&quot; &quot;GSM1150941&quot; &quot;GSM1150942&quot;</code></pre>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="gene-expression-omnibus.html#cb446-1"></a>unexposedIDs</span></code></pre></div>
<pre><code>## [1] &quot;GSM1150937&quot; &quot;GSM1150938&quot; &quot;GSM1150939&quot;</code></pre>
<p>With this we can tell that the first three listed IDs are from unexposed animals, and the last three IDs are from exposed animals</p>
<p>Let’s simplify the names of these columns to indicate exposure status and replicate number</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="gene-expression-omnibus.html#cb448-1"></a><span class="kw">colnames</span>(geodata) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control_1&quot;</span>, <span class="st">&quot;Control_2&quot;</span>, <span class="st">&quot;Control_3&quot;</span>, <span class="st">&quot;Exposed_1&quot;</span>, </span>
<span id="cb448-2"><a href="gene-expression-omnibus.html#cb448-2"></a>                       <span class="st">&quot;Exposed_2&quot;</span>, <span class="st">&quot;Exposed_3&quot;</span>)</span></code></pre></div>
<p>And we’ll now need to re-define our ‘exposed’ vs ‘unexposed’ vectors for downstream script</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="gene-expression-omnibus.html#cb449-1"></a>exposedIDs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Exposed_1&quot;</span>, <span class="st">&quot;Exposed_2&quot;</span>, <span class="st">&quot;Exposed_3&quot;</span>)</span>
<span id="cb449-2"><a href="gene-expression-omnibus.html#cb449-2"></a>unexposedIDs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control_1&quot;</span>, <span class="st">&quot;Control_2&quot;</span>, <span class="st">&quot;Control_3&quot;</span>)</span></code></pre></div>
<p>Viewing the data again</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="gene-expression-omnibus.html#cb450-1"></a><span class="kw">head</span>(geodata)</span></code></pre></div>
<pre><code>##          Control_1 Control_2 Control_3 Exposed_1 Exposed_2 Exposed_3
## 10700001   5786.60   5830.08   5637.34   5313.33   5557.04   5469.90
## 10700002    192.92    206.86    220.83    183.12    177.16    198.64
## 10700003   1820.98   1795.79   1735.70   1578.02   1681.58   1632.20
## 10700004     66.95     65.61     64.41     60.19     60.41     60.67
## 10700005    770.07    753.41    731.20    684.53    657.25    667.66
## 10700006      5.80      5.35      5.48      5.58      5.39      5.35</code></pre>
<p>These data are now looking easier to interpret/analyze. Still, the row identifiers include 8 digit numbers starting with “107…”. We know that this dataset is a gene expression dataset, but these identifiers, in themselves, don’t tell us much about what genes these are referring to. These numeric IDs specifically represent microarray probesetIDs, that were produced by the Affymetrix platform used in the original study.</p>
<p><strong>But how can we tell which genes are represented by these data?!</strong></p>
</div>
<div id="adding-gene-symbol-information-to--omic-data-sets-through-platform-annotation-files" class="section level4">
<h4>Adding Gene Symbol Information to -Omic Data Sets through Platform Annotation Files</h4>
<p>Each -omics dataset contained within GEO points to a specific platform that was used to obtain measurements.
In instances where we want more information surrounding the molecular identifiers, we can merge the platform-specific annotation file with the molecular IDs given in the full dataset.</p>
<p>For example, let’s pull the platform-specific annotation file for this experiment.</p>
<ul>
<li>Let’s revisit the <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42394">website</a> that contained the original dataset on GEO</li>
<li>Scroll down to where it lists “Platforms”, and there is a hyperlinked platform number “GPL6247” (see arrow below)</li>
</ul>
<p><img src="_book/TAME_Toolkit_files/figure-html/Module3_2_GEO_Screenshot2.png" width="509" /></p>
<ul>
<li>Click on this, and you will be navigated to a different GEO website describing the Affymetrix rat array platform that was used in this analysis</li>
<li>Note that this website also includes information on when this array became available, links to other experiments that have used this platform within GEO, and much more</li>
<li>Here, we’re interested in pulling the corresponding gene symbol information for the probeset IDs</li>
<li>To do so, scroll to the bottom, and click “Annotation SOFT table…” and download the corresponding .gz file within your working directory</li>
<li>Unzip this, and you will find the master annotation file: “GPL6247.annot”</li>
</ul>
<p>In this exercise, we’ve already done these steps and unzipped the file in our working directory. So at this point, we can simply read in this annotation dataset, still using the GEOquery function to help automate</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="gene-expression-omnibus.html#cb452-1"></a>geo.annot &lt;-<span class="st"> </span>GEOquery<span class="op">::</span><span class="kw">getGEO</span>(<span class="dt">filename=</span><span class="st">&quot;Module3_2/Module3_2_GPL6247.annot&quot;</span>)</span></code></pre></div>
<p>Now we can use the Table function from GEOquery to pull data from the annotation dataset</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="gene-expression-omnibus.html#cb453-1"></a>id.gene.table =<span class="st"> </span>GEOquery<span class="op">::</span><span class="kw">Table</span>(geo.annot)[,<span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;Gene symbol&quot;</span>)]</span>
<span id="cb453-2"><a href="gene-expression-omnibus.html#cb453-2"></a>id.gene.table[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>##          ID                        Gene symbol
## 1  10701620 Vom2r67///Vom2r5///Vom2r6///Vom2r4
## 2  10701630                                   
## 3  10701632                                   
## 4  10701636                                   
## 5  10701643                                   
## 6  10701648                             Vom2r5
## 7  10701654                             Vom2r6
## 8  10701663                                   
## 9  10701666                                   
## 10 10701668                   Vom2r65///Vom2r1</code></pre>
<p>With these two columns of data, we now have the needed IDs and gene symbols to match with our dataset.</p>
<p>Within the full dataset, we need to add a new column for the probeset ID, taken from the rownames, in preparation for the merging step</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="gene-expression-omnibus.html#cb455-1"></a>geodata<span class="op">$</span>ID =<span class="st"> </span><span class="kw">rownames</span>(geodata)</span></code></pre></div>
<p>We can now merge the gene symbol information by ID with our expression data</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="gene-expression-omnibus.html#cb456-1"></a>geodata_genes =<span class="st"> </span><span class="kw">merge</span>(geodata, id.gene.table, <span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</span>
<span id="cb456-2"><a href="gene-expression-omnibus.html#cb456-2"></a><span class="kw">head</span>(geodata_genes)</span></code></pre></div>
<pre><code>##         ID Control_1 Control_2 Control_3 Exposed_1 Exposed_2 Exposed_3
## 1 10700001   5786.60   5830.08   5637.34   5313.33   5557.04   5469.90
## 2 10700002    192.92    206.86    220.83    183.12    177.16    198.64
## 3 10700003   1820.98   1795.79   1735.70   1578.02   1681.58   1632.20
## 4 10700004     66.95     65.61     64.41     60.19     60.41     60.67
## 5 10700005    770.07    753.41    731.20    684.53    657.25    667.66
## 6 10700006      5.80      5.35      5.48      5.58      5.39      5.35
##   Gene symbol
## 1            
## 2            
## 3            
## 4            
## 5            
## 6</code></pre>
<p>Note that many of the probeset IDs do not map to full gene symbols, which is shown here by viewing the top few rows - this is expected in genome-wide analyses based on microarray platforms.</p>
<p>Let’s look at the first 25 unique genes in these data</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="gene-expression-omnibus.html#cb458-1"></a>UniqueGenes &lt;-<span class="st"> </span><span class="kw">unique</span>(geodata_genes<span class="op">$</span><span class="st">`</span><span class="dt">Gene symbol</span><span class="st">`</span>)</span>
<span id="cb458-2"><a href="gene-expression-omnibus.html#cb458-2"></a>UniqueGenes[<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>]</span></code></pre></div>
<pre><code>##  [1] &quot;&quot;                                           
##  [2] &quot;Vom2r67///Vom2r5///Vom2r6///Vom2r4&quot;         
##  [3] &quot;Vom2r5&quot;                                     
##  [4] &quot;Vom2r6&quot;                                     
##  [5] &quot;Vom2r65///Vom2r1&quot;                           
##  [6] &quot;Vom2r65///Vom2r5///Vom2r1///Vom2r6///Vom2r4&quot;
##  [7] &quot;Vom2r65///Vom2r5///Vom2r6///Vom2r4&quot;         
##  [8] &quot;Raet1e&quot;                                     
##  [9] &quot;Lrp11&quot;                                      
## [10] &quot;Katna1&quot;                                     
## [11] &quot;Ppil4&quot;                                      
## [12] &quot;Zc3h12d&quot;                                    
## [13] &quot;Shprh&quot;                                      
## [14] &quot;Fbxo30&quot;                                     
## [15] &quot;Epm2a&quot;                                      
## [16] &quot;Sf3b5&quot;                                      
## [17] &quot;Plagl1&quot;                                     
## [18] &quot;Fuca2&quot;                                      
## [19] &quot;Adat2&quot;                                      
## [20] &quot;Hivep2&quot;                                     
## [21] &quot;Nmbr&quot;                                       
## [22] &quot;Cited2&quot;                                     
## [23] &quot;Txlnb&quot;                                      
## [24] &quot;Reps1&quot;                                      
## [25] &quot;Perp&quot;</code></pre>
<p>Again, you can see that the first value listed is blank, representing probesetIDs that do not match to fully annotated gene symbols. Though the rest pertain for gene symbols annotated to the rat genome.</p>
<p>You can also see that some gene symbols have multiple entries, separated by “///”</p>
<p>To simplify identifiers, we can pull just the first gene symbol, and remove the rest by using gsub</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="gene-expression-omnibus.html#cb460-1"></a>geodata_genes<span class="op">$</span><span class="st">`</span><span class="dt">Gene symbol</span><span class="st">`</span> =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;///.*&quot;</span>, <span class="st">&quot;&quot;</span>, geodata_genes<span class="op">$</span><span class="st">`</span><span class="dt">Gene symbol</span><span class="st">`</span>)</span></code></pre></div>
<p>Let’s alphabetize by main expression dataframe by gene symbol</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="gene-expression-omnibus.html#cb461-1"></a>geodata_genes &lt;-<span class="st"> </span>geodata_genes[<span class="kw">order</span>(geodata_genes<span class="op">$</span><span class="st">`</span><span class="dt">Gene symbol</span><span class="st">`</span>),]</span></code></pre></div>
<p>And then re-view these data</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="gene-expression-omnibus.html#cb462-1"></a>geodata_genes[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</span></code></pre></div>
<pre><code>##         ID Control_1 Control_2 Control_3 Exposed_1 Exposed_2 Exposed_3
## 1 10700001   5786.60   5830.08   5637.34   5313.33   5557.04   5469.90
## 2 10700002    192.92    206.86    220.83    183.12    177.16    198.64
## 3 10700003   1820.98   1795.79   1735.70   1578.02   1681.58   1632.20
## 4 10700004     66.95     65.61     64.41     60.19     60.41     60.67
## 5 10700005    770.07    753.41    731.20    684.53    657.25    667.66
##   Gene symbol
## 1            
## 2            
## 3            
## 4            
## 5</code></pre>
<p>In preparation for the visualization steps below, let’s reset the probeset IDs to rownames</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="gene-expression-omnibus.html#cb464-1"></a><span class="kw">rownames</span>(geodata_genes) =<span class="st"> </span>geodata_genes<span class="op">$</span>ID</span>
<span id="cb464-2"><a href="gene-expression-omnibus.html#cb464-2"></a></span>
<span id="cb464-3"><a href="gene-expression-omnibus.html#cb464-3"></a><span class="co"># Can then remove this column within the dataframe</span></span>
<span id="cb464-4"><a href="gene-expression-omnibus.html#cb464-4"></a>geodata_genes<span class="op">$</span>ID &lt;-<span class="st"> </span><span class="ot">NULL</span></span></code></pre></div>
<p>Finally let’s rearrange this dataset to include gene symbols as the first column, right after rownames (probeset IDs)</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="gene-expression-omnibus.html#cb465-1"></a>geodata_genes &lt;-<span class="st"> </span>geodata_genes[,<span class="kw">c</span>(<span class="kw">ncol</span>(geodata_genes),<span class="dv">1</span><span class="op">:</span>(<span class="kw">ncol</span>(geodata_genes)<span class="op">-</span><span class="dv">1</span>))]</span>
<span id="cb465-2"><a href="gene-expression-omnibus.html#cb465-2"></a>geodata_genes[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</span></code></pre></div>
<pre><code>##          Gene symbol Control_1 Control_2 Control_3 Exposed_1 Exposed_2
## 10700001               5786.60   5830.08   5637.34   5313.33   5557.04
## 10700002                192.92    206.86    220.83    183.12    177.16
## 10700003               1820.98   1795.79   1735.70   1578.02   1681.58
## 10700004                 66.95     65.61     64.41     60.19     60.41
## 10700005                770.07    753.41    731.20    684.53    657.25
##          Exposed_3
## 10700001   5469.90
## 10700002    198.64
## 10700003   1632.20
## 10700004     60.67
## 10700005    667.66</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="gene-expression-omnibus.html#cb467-1"></a><span class="kw">dim</span>(geodata_genes)</span></code></pre></div>
<pre><code>## [1] 29214     7</code></pre>
<p>Note that this dataset includes expression measures across <strong>29,214 probes, representing 14,019 unique genes</strong>.
For simplicity in the final excercises, let’s just filter for rows representing mapped genes</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="gene-expression-omnibus.html#cb469-1"></a>geodata_genes &lt;-<span class="st"> </span>geodata_genes[<span class="op">!</span>(geodata_genes<span class="op">$</span><span class="st">`</span><span class="dt">Gene symbol</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;&quot;</span>), ]</span>
<span id="cb469-2"><a href="gene-expression-omnibus.html#cb469-2"></a><span class="kw">dim</span>(geodata_genes)</span></code></pre></div>
<pre><code>## [1] 16024     7</code></pre>
<p>Note that this dataset now includes 16,024 rows with mapped gene symbol identifiers</p>
<!-- #### With this, we can now answer **Environmental Health Question #1**: -->
<!-- #### (1) What kind of molecular identifiers are commonly used in microarray-based -omics technologies? -->
<!-- #### *Answer: Platform-specific probeset IDs.* -->
<div class="question">
<p><i>With this, we can now answer <strong>Environmental Health Question 1</strong>:</i>
What kind of molecular identifiers are commonly used in microarray-based -omics technologies?</p>
</div>
<div class="answer">
<p><strong>Answer</strong>: Platform-specific probeset IDs.</p>
</div>
<!-- #### We can also answer **Environmental Health Question #2**: -->
<!-- #### (2) How can we convert platform-specific molecular identifiers used in -omics study designs to gene-level information? -->
<!-- #### *Answer: We can merge platform-specific IDs with gene-level information using annotation files.* -->
<div class="question">
<p><i>We can also answer <strong>Environmental Health Question 2</strong>:</i>
How can we convert platform-specific molecular identifiers used in -omics study designs to gene-level information?</p>
</div>
<div class="answer">
<p><strong>Answer</strong>: We can merge platform-specific IDs with gene-level information using annotation files.</p>
</div>
</div>
</div>
<div id="visualizing-data" class="section level2">
<h2>Visualizing Data</h2>
<div id="visualizing-gene-expression-data-using-boxplots-and-heat-maps" class="section level4">
<h4>Visualizing Gene Expression Data using Boxplots and Heat Maps</h4>
<ul>
<li>To visualize the -omics data, we can generate boxplots, heatmaps, any many other types of visualizations</li>
<li>Here, we provide an example to plot a boxplot, which can be used to visualize the variability amongst samples</li>
<li>We also provide an example to plot a heat map, compared unscaled vs scaled gene expression profiles</li>
<li>These visualizations can be useful to both simply visualize the data as well as identify patterns across samples or genes</li>
</ul>
</div>
<div id="boxplot-visualizations-1" class="section level4">
<h4>Boxplot Visualizations</h4>
<p>For this example, let’s simply use R’s built in boxplot function</p>
<p>We only want to use columns with our expression data (2 to 7), so let’s pull those columns when running the boxplot function
<img src="03-Chapter3_files/figure-html/unnamed-chunk-67-1.png" width="480" /></p>
<p>There seem to be a lot of variability within each sample’s range of expression levels, with many outliers. This makes sense given that we are analyzing the expression levels across the rat’s entire genome, where some genes won’t be expressed at all while others will be highly expressed due to biological and/or potential technical variability.</p>
<p>To show plots without outliers, we can simply use outline=F<br />
<img src="03-Chapter3_files/figure-html/unnamed-chunk-68-1.png" width="480" /></p>
</div>
<div id="heatmap-visualizations-1" class="section level4">
<h4>Heatmap Visualizations</h4>
<p>Heatmaps are also useful when evaluating large datasets.</p>
<p>There are many different packages you can use to generate heat maps. Here, we use the <em>superheat</em> package.</p>
<p>It also takes awhile to plot all genes across the genome, so to save time for this training module, let’s randomly select 100 rows to plot.</p>
<p><img src="03-Chapter3_files/figure-html/unnamed-chunk-69-1.png" width="864" /></p>
<p>This produces a heat map with sample IDs along the x-axis and probeset IDs along the y-axis. Here, the values being displayed represent normalized expression values.</p>
<p>One way to improve our ability to distinguish differences between samples is to <strong>scale expression values</strong> across probes.</p>
</div>
<div id="scaling-data" class="section level4">
<h4>Scaling data</h4>
<p>Z-score is a very common method of scaling that transforms data points to reflect the number of standard deviations they are from the overall mean. Z-score scaling data results in the overall transformation of a dataset to have an overall mean = 0 and standard deviation = 1.</p>
<p>Let’s see what happens when we scale this gene expression dataset by z-score across each probe. This can be easily done using the <em>scale</em> function.</p>
<p>This specific <em>scale</em> function works by centering and scaling across columns, but since we want use it across probesets (organized as rows), we need to first transpose our dataset, then running the scale function</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="gene-expression-omnibus.html#cb471-1"></a>geodata_genes_scaled =<span class="st"> </span><span class="kw">scale</span>(<span class="kw">t</span>(geodata_genes[,<span class="dv">2</span><span class="op">:</span><span class="dv">7</span>]), <span class="dt">center=</span>T, <span class="dt">scale=</span>T)</span></code></pre></div>
<p>Now we can transpose it back to the original format (i.e., before it was transposed)</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="gene-expression-omnibus.html#cb472-1"></a>geodata_genes_scaled =<span class="st"> </span><span class="kw">t</span>(geodata_genes_scaled)</span></code></pre></div>
<p>And then view what the normalized and now scaled expression data look like for now a random subset of 100 probesets (representing genes)
<img src="03-Chapter3_files/figure-html/unnamed-chunk-72-1.png" width="864" /></p>
<p>With these data now scaled, we can more easily visualize patterns between samples.</p>
<!-- #### We can also answer **Environmental Health Question #3**: -->
<!-- #### (3) Why do we often scale gene expression signatures prior to heat map visualizations? -->
<!-- #### *Answer: To better visualize patterns in expression signatures between samples.* -->
<div class="question">
<p><i>We can also answer <strong>Environmental Health Question 3</strong>:</i>
Why do we often scale gene expression signatures prior to heat map visualizations?</p>
</div>
<div class="answer">
<p><strong>Answer</strong>: To better visualize patterns in expression signatures between samples.</p>
</div>
<p>Now, with these data nicely organized, we can see how statistics can help find which genes show trends in expression associated with formaldehyde exposure.</p>
<hr />
</div>
</div>
<div id="statistical-analyses" class="section level2">
<h2>Statistical Analyses</h2>
<div id="statistical-analyses-to-identify-genes-altered-by-formaldehyde" class="section level4">
<h4>Statistical Analyses to Identify Genes altered by Formaldehyde</h4>
<p>A simple way to identify differences between formaldehyde-exposed and unexposed samples is to use a t-test. Because there are so many tests being performed, one for each gene, it is also important to carry out multiple test corrections through a p-value adjustment method.</p>
<p>We need to run a t-test for each row of our dataset. This exercise demonstrates two different methods to run a t-test:
+ Method 1: using a ‘for loop’
+ Method 2: using the apply function (more computationally efficient)</p>
</div>
<div id="method-1-m1-for-loop" class="section level4">
<h4>Method 1 (m1): ‘For Loop’</h4>
<p>Let’s first re-save the molecular probe IDs to a column within the dataframe, since we need those values in the loop function</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="gene-expression-omnibus.html#cb473-1"></a>geodata_genes<span class="op">$</span>ID =<span class="st"> </span><span class="kw">rownames</span>(geodata_genes)</span></code></pre></div>
<p>We also need to initially create an empty dataframe to eventually store p-values</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="gene-expression-omnibus.html#cb474-1"></a>pValue_m1 =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="kw">nrow</span>(geodata_genes), <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb474-2"><a href="gene-expression-omnibus.html#cb474-2"></a><span class="kw">colnames</span>(pValue_m1) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;pval&quot;</span>, <span class="st">&quot;padj&quot;</span>)</span>
<span id="cb474-3"><a href="gene-expression-omnibus.html#cb474-3"></a><span class="kw">head</span>(pValue_m1)</span></code></pre></div>
<pre><code>##      ID pval padj
## [1,]  0    0    0
## [2,]  0    0    0
## [3,]  0    0    0
## [4,]  0    0    0
## [5,]  0    0    0
## [6,]  0    0    0</code></pre>
<p>You can see the empty dataframe that was generated through this code</p>
<p>Then we can loop through the entire dataset to acquire p-values from t-test statistics, comparing n=3 exposed vs n=3 unexposed samples</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="gene-expression-omnibus.html#cb476-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(geodata_genes)) {</span>
<span id="cb476-2"><a href="gene-expression-omnibus.html#cb476-2"></a>  </span>
<span id="cb476-3"><a href="gene-expression-omnibus.html#cb476-3"></a>  <span class="co">#Get the ID</span></span>
<span id="cb476-4"><a href="gene-expression-omnibus.html#cb476-4"></a>  ID.i =<span class="st"> </span>geodata_genes[i, <span class="st">&quot;ID&quot;</span>];</span>
<span id="cb476-5"><a href="gene-expression-omnibus.html#cb476-5"></a>  </span>
<span id="cb476-6"><a href="gene-expression-omnibus.html#cb476-6"></a>  <span class="co">#Run the t-test and get the p-value</span></span>
<span id="cb476-7"><a href="gene-expression-omnibus.html#cb476-7"></a>  pval.i =<span class="st"> </span><span class="kw">t.test</span>(geodata_genes[i,exposedIDs], geodata_genes[i,unexposedIDs])<span class="op">$</span>p.value;</span>
<span id="cb476-8"><a href="gene-expression-omnibus.html#cb476-8"></a>  </span>
<span id="cb476-9"><a href="gene-expression-omnibus.html#cb476-9"></a>  <span class="co">#Store the data in the empty dataframe</span></span>
<span id="cb476-10"><a href="gene-expression-omnibus.html#cb476-10"></a>  pValue_m1[i,<span class="st">&quot;ID&quot;</span>] =<span class="st"> </span>ID.i;</span>
<span id="cb476-11"><a href="gene-expression-omnibus.html#cb476-11"></a>  pValue_m1[i,<span class="st">&quot;pval&quot;</span>] =<span class="st"> </span>pval.i</span>
<span id="cb476-12"><a href="gene-expression-omnibus.html#cb476-12"></a>  </span>
<span id="cb476-13"><a href="gene-expression-omnibus.html#cb476-13"></a>}</span></code></pre></div>
<p>View the results</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="gene-expression-omnibus.html#cb477-1"></a><span class="co"># Note that we&#39;re not pulling the last column (padj) since we haven&#39;t calculated these yet</span></span>
<span id="cb477-2"><a href="gene-expression-omnibus.html#cb477-2"></a>pValue_m1[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] </span></code></pre></div>
<pre><code>##      ID         pval                
## [1,] &quot;10903987&quot; &quot;0.0812802229304083&quot;
## [2,] &quot;10714794&quot; &quot;0.757311314118124&quot; 
## [3,] &quot;10858408&quot; &quot;0.390952310869689&quot; 
## [4,] &quot;10872252&quot; &quot;0.0548937136005506&quot;
## [5,] &quot;10905819&quot; &quot;0.173539535577791&quot;</code></pre>
</div>
<div id="method-2-m2-apply-function" class="section level4">
<h4>Method 2 (m2): Apply Function</h4>
<p>For the second method, we can use the <em>apply</em> to do calculate resulting t-test p-values more efficiently (labeled</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="gene-expression-omnibus.html#cb479-1"></a>pValue_m2 &lt;-<span class="st"> </span><span class="kw">apply</span>(geodata_genes[,<span class="dv">2</span><span class="op">:</span><span class="dv">7</span>], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">t.test</span>(x[unexposedIDs],</span>
<span id="cb479-2"><a href="gene-expression-omnibus.html#cb479-2"></a>                                                              x[exposedIDs])<span class="op">$</span>p.value)</span>
<span id="cb479-3"><a href="gene-expression-omnibus.html#cb479-3"></a><span class="kw">names</span>(pValue_m2) =<span class="st"> </span>geodata_genes[,<span class="st">&quot;ID&quot;</span>]</span></code></pre></div>
<p>We can convert the results into a dataframe to make it similar to m1 matrix we created above</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="gene-expression-omnibus.html#cb480-1"></a>pValue_m2  =<span class="st"> </span><span class="kw">data.frame</span>(pValue_m2)</span>
<span id="cb480-2"><a href="gene-expression-omnibus.html#cb480-2"></a></span>
<span id="cb480-3"><a href="gene-expression-omnibus.html#cb480-3"></a><span class="co"># Now create an ID column</span></span>
<span id="cb480-4"><a href="gene-expression-omnibus.html#cb480-4"></a>pValue_m2<span class="op">$</span>ID =<span class="st"> </span><span class="kw">rownames</span>(pValue_m2)</span></code></pre></div>
<p>Then we can view at the two datasets to see they result in the same pvalues</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="gene-expression-omnibus.html#cb481-1"></a><span class="kw">head</span>(pValue_m1)</span></code></pre></div>
<pre><code>##      ID         pval                 padj
## [1,] &quot;10903987&quot; &quot;0.0812802229304083&quot; &quot;0&quot; 
## [2,] &quot;10714794&quot; &quot;0.757311314118124&quot;  &quot;0&quot; 
## [3,] &quot;10858408&quot; &quot;0.390952310869689&quot;  &quot;0&quot; 
## [4,] &quot;10872252&quot; &quot;0.0548937136005506&quot; &quot;0&quot; 
## [5,] &quot;10905819&quot; &quot;0.173539535577791&quot;  &quot;0&quot; 
## [6,] &quot;10907585&quot; &quot;0.215200167867295&quot;  &quot;0&quot;</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="gene-expression-omnibus.html#cb483-1"></a><span class="kw">head</span>(pValue_m2)</span></code></pre></div>
<pre><code>##           pValue_m2       ID
## 10903987 0.08128022 10903987
## 10714794 0.75731131 10714794
## 10858408 0.39095231 10858408
## 10872252 0.05489371 10872252
## 10905819 0.17353954 10905819
## 10907585 0.21520017 10907585</code></pre>
<p>We can see from these results that both methods (m1 and m2) generate the same statistical p-values</p>
</div>
<div id="interpreting-results" class="section level4">
<h4>Interpreting Results</h4>
<p>Let’s again merge these data with the gene symbols to tell which genes are significant</p>
<p>First, let’s convert to a dataframe and then merge as before, for one of the above methods as an example (m1)</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="gene-expression-omnibus.html#cb485-1"></a>pValue_m1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(pValue_m1)</span>
<span id="cb485-2"><a href="gene-expression-omnibus.html#cb485-2"></a>pValue_m1 &lt;-<span class="st"> </span><span class="kw">merge</span>(pValue_m1, id.gene.table, <span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
<p>We can also add a multiple test correction by applying a false discovery rate-adjusted p-value; here, using the Benjamini Hochberg (BH) method</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="gene-expression-omnibus.html#cb486-1"></a>pValue_m1[,<span class="st">&quot;padj&quot;</span>] &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(pValue_m1[,<span class="st">&quot;pval&quot;</span>], <span class="dt">method=</span><span class="kw">c</span>(<span class="st">&quot;fdr&quot;</span>))</span></code></pre></div>
<p>Now, we can sort these statistical results by adjusted p-values</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="gene-expression-omnibus.html#cb487-1"></a>pValue_m1.sorted &lt;-<span class="st"> </span>pValue_m1[<span class="kw">order</span>(pValue_m1[,<span class="st">&#39;padj&#39;</span>]),]</span>
<span id="cb487-2"><a href="gene-expression-omnibus.html#cb487-2"></a><span class="kw">head</span>(pValue_m1.sorted)</span></code></pre></div>
<pre><code>##            ID                 pval       padj Gene symbol
## 9143 10837582 4.57288413593085e-07 0.00732759      Olr633
## 5640 10783648 1.93688668590855e-06 0.01551834      Slc7a8
## 8    10701699   0.0166773380386967 0.13089115       Lrp11
## 17   10701817   0.0131845685452954 0.13089115       Fuca2
## 19   10701830  0.00586885826460337 0.13089115      Hivep2
## 23   10701880  0.00749149990409956 0.13089115       Reps1</code></pre>
<p>Pulling just the significant genes using an adjusted p-value threshold of 0.05</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="gene-expression-omnibus.html#cb489-1"></a>adj.pval.sig &lt;-<span class="st"> </span>pValue_m1[<span class="kw">which</span>(pValue_m1[,<span class="st">&#39;padj&#39;</span>] <span class="op">&lt;</span><span class="st"> </span><span class="fl">.05</span>),]</span>
<span id="cb489-2"><a href="gene-expression-omnibus.html#cb489-2"></a></span>
<span id="cb489-3"><a href="gene-expression-omnibus.html#cb489-3"></a><span class="co"># Viewing these genes</span></span>
<span id="cb489-4"><a href="gene-expression-omnibus.html#cb489-4"></a>adj.pval.sig       </span></code></pre></div>
<pre><code>##            ID                 pval       padj Gene symbol
## 5640 10783648 1.93688668590855e-06 0.01551834      Slc7a8
## 9143 10837582 4.57288413593085e-07 0.00732759      Olr633</code></pre>
<!-- #### With this, we can answer **Environmental Health Question #4**: -->
<!-- #### (4) What genes are altered in expression by formaldehyde inhalation exposure? -->
<!-- #### *Answer: Olr633 and Slc7a8.* -->
<div class="question">
<p><i>With this, we can answer <strong>Environmental Health Question 4</strong>:</i>
What genes are altered in expression by formaldehyde inhalation exposure?</p>
</div>
<div class="answer">
<p><strong>Answer</strong>: Olr633 and Slc7a8.</p>
</div>
<!-- #### With this, we can answer **Environmental Health Question #5**: -->
<!-- #### (5) What are the potential biological consequences of these gene-level perturbations? -->
<!-- #### *Answer: Olr633 stands for 'olfactory receptor 633'. Olr633 is up-regulated in expression, meaning that formaldehyde inhalation exposure has a smell that resulted in 'activated' olfactory receptors in the nose of these exposed rats. Slc7a8 stands for 'solute carrier family 7 member 8'. Slc7a8 is down-regulated in expression, and it plays a role in many biological processes, that when altered, can lead to changes in cellular homeostasis and disease.* -->
<div class="question">
<p><i>With this, we can answer <strong>Environmental Health Question 5</strong>:</i>
What are the potential biological consequences of these gene-level perturbations?</p>
</div>
<div class="answer">
<p><strong>Answer</strong>: Olr633 stands for ‘olfactory receptor 633’. Olr633 is up-regulated in expression, meaning that formaldehyde inhalation exposure has a smell that resulted in ‘activated’ olfactory receptors in the nose of these exposed rats. Slc7a8 stands for ‘solute carrier family 7 member 8’. Slc7a8 is down-regulated in expression, and it plays a role in many biological processes, that when altered, can lead to changes in cellular homeostasis and disease.</p>
</div>
<p>Finally, let’s plot these using a mini heatmap.
Note that we can use probesetIDs, then gene symbols, in rownames to have them show in heatmap labels.
<img src="03-Chapter3_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>Note that this statistical filter is pretty strict when comparing only n=3 vs n=3 biological replicates. If we loosen the statistical criteria to p-value &lt; 0.05, this is what we can find:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="gene-expression-omnibus.html#cb491-1"></a>pval.sig =<span class="st"> </span>pValue_m1[<span class="kw">which</span>(pValue_m1[,<span class="st">&#39;pval&#39;</span>] <span class="op">&lt;</span><span class="st"> </span><span class="fl">.05</span>),]</span>
<span id="cb491-2"><a href="gene-expression-omnibus.html#cb491-2"></a><span class="kw">nrow</span>(pval.sig)</span></code></pre></div>
<pre><code>## [1] 5327</code></pre>
<p>5327 genes with significantly altered expression!</p>
<p>Note that other filters are commonly applied to further focus these lists (e.g., background and fold change filters) prior to statistical evaluation, which can impact the final results. See <a href="https://pubmed.ncbi.nlm.nih.gov/24304932/">Rager et al. 2013</a> for further statistical approaches and visualizations.</p>
</div>
</div>
<div id="concluding-remarks-11" class="section level2">
<h2>Concluding Remarks</h2>
<p>In conclusion, this training module provides an overview of pulling, organizing, visualizing, and analyzing -omics data from the online repository, Gene Expression Omnibus (GEO). Trainees are guided through the overall organization of an example high dimensional dataset, focusing on transcriptomic responses in the nasal epithelium of rats exposed to formaldehyde. Data are visualized and then analyzed using standard two-group comparisons. Findings are interpreted for biological relevance, yielding insight into the effects resulting from formaldehyde exposure.</p>
<p>For additional case studies that leverage GEO, see the following publications that also address environmental health questions from our research group:</p>
<ul>
<li><p>Rager JE, Fry RC. The aryl hydrocarbon receptor pathway: a key component of the microRNA-mediated AML signalisome. Int J Environ Res Public Health. 2012 May;9(5):1939-53. doi: 10.3390/ijerph9051939. Epub 2012 May 18. PMID: 22754483; PMCID: <a href="https://pubmed.ncbi.nlm.nih.gov/22754483/">PMC3386597</a>.</p></li>
<li><p>Rager JE, Suh M, Chappell GA, Thompson CM, Proctor DM. Review of transcriptomic responses to hexavalent chromium exposure in lung cells supports a role of epigenetic mediators in carcinogenesis. Toxicol Lett. 2019 May 1;305:40-50. PMID: <a href="https://pubmed.ncbi.nlm.nih.gov/30690063/">30690063</a>.</p></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="comparative-toxicogenomics-database.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="database-integration-air-quality-study-mortality-and-environmental-justice-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TAME_Toolkit.pdf", "TAME_Toolkit.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
