<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.3 Finding and Visualizing Data Trends | The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research</title>
  <meta name="description" content="1.3 Finding and Visualizing Data Trends | The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="1.3 Finding and Visualizing Data Trends | The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.3 Finding and Visualizing Data Trends | The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research" />
  
  
  

<meta name="author" content="Kyle R. Roell, Lauren E. Koval, Rebecca Boyles, Grace Patlewicz, Caroline Ring, Cynthia Rider, Cavin Ward-Caviness, David M. Reif, Ilona Jaspers, Rebecca C. Fry, and Julia E. Rager" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/Favicon_v1.png" type="image/x-icon" />
<link rel="prev" href="data-organization-basics.html"/>
<link rel="next" href="high-dimensional-data-visualizations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/Data Training Icon for Top Left Bookdown_v2.png"><br></a></li>

<li class="divider"></li>
<li><a href="index.html#preface">Preface<span></span></a></li>
<li class="part"><span><b>Chapter 1 Introductory <br>Data Science<span></span></b></span></li>
<li><a href="introduction-to-coding-in-r.html#introduction-to-coding-in-r">1.1 Introduction to Coding in R<span></span></a>
<ul>
<li><a href="introduction-to-coding-in-r.html#introduction-to-training-module">Introduction to Training Module<span></span></a></li>
<li><a href="introduction-to-coding-in-r.html#r-packages">R Packages<span></span></a></li>
<li><a href="introduction-to-coding-in-r.html#scripting-basics">Scripting Basics<span></span></a></li>
<li><a href="introduction-to-coding-in-r.html#concluding-remarks-1">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="data-organization-basics.html#data-organization-basics">1.2 Data Organization Basics<span></span></a>
<ul>
<li><a href="data-organization-basics.html#introduction-to-training-module-1">Introduction to Training Module<span></span></a></li>
<li><a href="data-organization-basics.html#data-manipulation-using-base-r">Data Manipulation using Base R<span></span></a></li>
<li><a href="data-organization-basics.html#introduction-to-tidyverse">Introduction to Tidyverse<span></span></a></li>
<li><a href="data-organization-basics.html#concluding-remarks-2">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="finding-and-visualizing-data-trends.html#finding-and-visualizing-data-trends">1.3 Finding and Visualizing Data Trends<span></span></a>
<ul>
<li><a href="finding-and-visualizing-data-trends.html#introduction-to-training-module-2">Introduction to Training Module<span></span></a></li>
<li><a href="finding-and-visualizing-data-trends.html#basic-data-analysis">Basic Data Analysis<span></span></a></li>
<li><a href="finding-and-visualizing-data-trends.html#regression-modeling">Regression Modeling<span></span></a></li>
<li><a href="finding-and-visualizing-data-trends.html#categorical-data-analysis">Categorical Data Analysis<span></span></a></li>
<li><a href="finding-and-visualizing-data-trends.html#concluding-remarks-3">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="high-dimensional-data-visualizations.html#high-dimensional-data-visualizations">1.4 High-Dimensional Data Visualizations<span></span></a>
<ul>
<li><a href="high-dimensional-data-visualizations.html#introduction-to-training-module-3">Introduction to Training Module<span></span></a></li>
<li><a href="high-dimensional-data-visualizations.html#high-dimensional-data-visualizations-1">High-Dimensional Data Visualizations<span></span></a></li>
<li><a href="high-dimensional-data-visualizations.html#density-plot-visualizations">Density Plot Visualizations<span></span></a></li>
<li><a href="high-dimensional-data-visualizations.html#ggally-visualizations">GGally Visualizations<span></span></a></li>
<li><a href="high-dimensional-data-visualizations.html#boxplot-visualizations">Boxplot Visualizations<span></span></a></li>
<li><a href="high-dimensional-data-visualizations.html#correlation-plot-visualizations">Correlation Plot Visualizations<span></span></a></li>
<li><a href="high-dimensional-data-visualizations.html#hierarchical-clustering-visualizations">Hierarchical Clustering Visualizations<span></span></a>
<ul>
<li><a href="high-dimensional-data-visualizations.html#heat-map-visualizations">Heat Map Visualizations<span></span></a></li>
</ul></li>
<li><a href="high-dimensional-data-visualizations.html#concluding-remarks-4">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="fair-data-management-practices.html#fair-data-management-practices">1.5 FAIR Data Management Practices<span></span></a>
<ul>
<li><a href="fair-data-management-practices.html#introduction-to-training-module-4">Introduction to Training Module<span></span></a></li>
<li><a href="fair-data-management-practices.html#introduction-to-fair">Introduction to FAIR<span></span></a></li>
<li><a href="fair-data-management-practices.html#breaking-down-fair-letter-by-letter">Breaking Down FAIR, Letter-by-Letter<span></span></a></li>
<li><a href="fair-data-management-practices.html#data-repositories-for-sharing-of-data">Data Repositories for Sharing of Data<span></span></a></li>
<li><a href="fair-data-management-practices.html#helpful-resources-on-fair">Helpful Resources on FAIR<span></span></a></li>
<li><a href="fair-data-management-practices.html#concluding-remarks-5">Concluding Remarks<span></span></a></li>
</ul></li>
<li class="part"><span><b>Chapter 2 Chemical-<br>Biological Analyses <br>and Predictive Modeling<span></span></b></span></li>
<li><a href="dose-response-modeling.html#dose-response-modeling">2.1 Dose-Response Modeling<span></span></a>
<ul>
<li><a href="dose-response-modeling.html#introduction-to-training-module-5">Introduction to Training Module<span></span></a></li>
<li><a href="dose-response-modeling.html#plotting-data-in-dose-response">Plotting Data in Dose-Response<span></span></a></li>
<li><a href="dose-response-modeling.html#dose-response-curve-fitting">Dose-Response Curve Fitting<span></span></a></li>
<li><a href="dose-response-modeling.html#comparing-curve-fits">Comparing Curve Fits<span></span></a></li>
<li><a href="dose-response-modeling.html#curve-fitting-example">Curve Fitting Example<span></span></a></li>
<li><a href="dose-response-modeling.html#deriving-benchmark-dose">Deriving Benchmark Dose<span></span></a></li>
<li><a href="dose-response-modeling.html#concluding-remarks-6">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="machine-learning-and-predictive-modeling.html#machine-learning-and-predictive-modeling">2.2 Machine Learning and Predictive Modeling<span></span></a>
<ul>
<li><a href="machine-learning-and-predictive-modeling.html#introduction-to-training-module-6">Introduction to Training Module<span></span></a></li>
<li><a href="machine-learning-and-predictive-modeling.html#k-means-analysis">K-means Analysis<span></span></a></li>
<li><a href="machine-learning-and-predictive-modeling.html#principal-component-analysis">Principal Component Analysis<span></span></a></li>
<li><a href="machine-learning-and-predictive-modeling.html#combining-k-means-with-pca">Combining K-Means with PCA<span></span></a></li>
<li><a href="machine-learning-and-predictive-modeling.html#concluding-remarks-7">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="mixtures-analyses.html#mixtures-analyses">2.3 Mixtures Analyses<span></span></a>
<ul>
<li><a href="mixtures-analyses.html#introduction-to-training-module-7">Introduction to Training Module<span></span></a></li>
<li><a href="mixtures-analyses.html#chemistry-based-approach">Chemistry-based Approach<span></span></a></li>
<li><a href="mixtures-analyses.html#toxicity-based-approach">Toxicity-based Approach<span></span></a></li>
<li><a href="mixtures-analyses.html#comparing-results">Comparing Results<span></span></a></li>
<li><a href="mixtures-analyses.html#concluding-remarks-8">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="omics-analyses-and-systems-biology.html#omics-analyses-and-systems-biology">2.4 -Omics Analyses and Systems Biology<span></span></a>
<ul>
<li><a href="omics-analyses-and-systems-biology.html#introduction-to-training-module-8">Introduction to Training Module<span></span></a></li>
<li><a href="omics-analyses-and-systems-biology.html#transcriptomics-data-qaqc">Transcriptomics Data QA/QC<span></span></a></li>
<li><a href="omics-analyses-and-systems-biology.html#statistical-analysis-of-gene-expression">Statistical Analysis of Gene Expression<span></span></a></li>
<li><a href="omics-analyses-and-systems-biology.html#ma-plots">MA Plots<span></span></a></li>
<li><a href="omics-analyses-and-systems-biology.html#volcano-plots">Volcano Plots<span></span></a></li>
<li><a href="omics-analyses-and-systems-biology.html#pathway-enrichment-analysis">Pathway Enrichment Analysis<span></span></a></li>
<li><a href="omics-analyses-and-systems-biology.html#concluding-remarks-9">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="toxicokinetic-modeling.html#toxicokinetic-modeling">2.5 Toxicokinetic Modeling<span></span></a>
<ul>
<li><a href="toxicokinetic-modeling.html#introduction-to-training-module-9">Introduction to Training Module<span></span></a></li>
<li><a href="toxicokinetic-modeling.html#data-and-models-used-in-toxicokinetic-modeling-tk">Data and Models used in Toxicokinetic Modeling (TK)<span></span></a></li>
<li><a href="toxicokinetic-modeling.html#calculating-steady-state-concentration">Calculating steady-state concentration<span></span></a></li>
<li><a href="toxicokinetic-modeling.html#reverse-toxicokinetics">Reverse Toxicokinetics<span></span></a></li>
<li><a href="toxicokinetic-modeling.html#monte-carlo-approach">Monte Carlo Approach<span></span></a></li>
<li><a href="toxicokinetic-modeling.html#chemical-specific-example">Chemical-Specific Example<span></span></a></li>
<li><a href="toxicokinetic-modeling.html#calculating-bioactivity-exposure-ratios-bers">Calculating Bioactivity-Exposure Ratios (BERs)<span></span></a></li>
<li><a href="toxicokinetic-modeling.html#concluding-remarks-10">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="read-across-toxicity-predictions.html#read-across-toxicity-predictions">2.6 Read-Across Toxicity Predictions<span></span></a>
<ul>
<li><a href="read-across-toxicity-predictions.html#introduction-to-training-module-10">Introduction to Training Module<span></span></a></li>
<li><a href="read-across-toxicity-predictions.html#read-across-example-analysis">Read-Across Example Analysis<span></span></a></li>
<li><a href="read-across-toxicity-predictions.html#calculating-chemical-similarities">Calculating Chemical Similarities<span></span></a></li>
<li><a href="read-across-toxicity-predictions.html#chemical-read-across-to-predict-acute-toxicity">Chemical Read-Across to Predict Acute Toxicity<span></span></a></li>
<li><a href="read-across-toxicity-predictions.html#concluding-remarks-11">Concluding Remarks<span></span></a></li>
</ul></li>
<li class="part"><span><b>Chapter 3 Environmental <br>Health Database Mining<span></span></b></span></li>
<li><a href="comparative-toxicogenomics-database.html#comparative-toxicogenomics-database">3.1 Comparative Toxicogenomics Database<span></span></a>
<ul>
<li><a href="comparative-toxicogenomics-database.html#introduction-to-training-module-11">Introduction to Training Module<span></span></a></li>
<li><a href="comparative-toxicogenomics-database.html#ctd-data-in-r">CTD Data in R<span></span></a></li>
<li><a href="comparative-toxicogenomics-database.html#identifying-genes-under-epigenetic-control">Identifying Genes under Epigenetic Control<span></span></a></li>
<li><a href="comparative-toxicogenomics-database.html#concluding-remarks-12">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="gene-expression-omnibus.html#gene-expression-omnibus">3.2 Gene Expression Omnibus<span></span></a>
<ul>
<li><a href="gene-expression-omnibus.html#introduction-to-training-module-12">Introduction to Training Module<span></span></a>
<ul>
<li><a href="gene-expression-omnibus.html#training-modules-environmental-health-questions-7">Training Module’s <strong>Environmental Health Questions</strong><span></span></a></li>
</ul></li>
<li><a href="gene-expression-omnibus.html#geo-data-in-r">GEO Data in R<span></span></a></li>
<li><a href="gene-expression-omnibus.html#visualizing-data">Visualizing Data<span></span></a></li>
<li><a href="gene-expression-omnibus.html#statistical-analyses">Statistical Analyses<span></span></a></li>
<li><a href="gene-expression-omnibus.html#concluding-remarks-13">Concluding Remarks<span></span></a></li>
</ul></li>
<li><a href="database-integration-air-quality-mortality-and-environmental-justice-data.html#database-integration-air-quality-mortality-and-environmental-justice-data">3.3 Database Integration: Air Quality, Mortality, and Environmental Justice Data<span></span></a>
<ul>
<li><a href="database-integration-air-quality-mortality-and-environmental-justice-data.html#introduction-to-training-module-13">Introduction to Training Module<span></span></a></li>
<li><a href="database-integration-air-quality-mortality-and-environmental-justice-data.html#population-weighted-vs-unweighted-exposures">Population-weighted vs Unweighted Exposures<span></span></a></li>
<li><a href="database-integration-air-quality-mortality-and-environmental-justice-data.html#regression-modeling-1">Regression Modeling<span></span></a></li>
<li><a href="database-integration-air-quality-mortality-and-environmental-justice-data.html#environmental-justice-considerations">Environmental Justice Considerations<span></span></a></li>
<li><a href="database-integration-air-quality-mortality-and-environmental-justice-data.html#concluding-remarks-14">Concluding Remarks<span></span></a></li>
</ul></li>
<li class="part"><span><b>Additional Resources<span></span></b></span></li>
<li><a href="resources.html#resources">Resources<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The inTelligence And Machine lEarning (TAME) Toolkit for Introductory Data Science, Chemical-Biological Analyses, Predictive Modeling, and Database Mining for Environmental Health Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="finding-and-visualizing-data-trends" class="section level1 hasAnchor">
<h1>1.3 Finding and Visualizing Data Trends<a href="finding-and-visualizing-data-trends.html#finding-and-visualizing-data-trends" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This training module was developed by Dr. Kyle R. Roell and Dr. Julia E. Rager</p>
<p>Fall 2021</p>
<div id="introduction-to-training-module-2" class="section level2 hasAnchor">
<h2>Introduction to Training Module<a href="finding-and-visualizing-data-trends.html#introduction-to-training-module-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This training module provides a brief introduction to some of the most commonly implemented statistics and associated visualizations used in exposure science, epidemiological, toxicology, and environmental health studies. This module first uploads an example dataset that is similar to the data used in the previous data organization training module, though includes some expanded subject information data to allow for more example statistical tests. Then, methods to evaluate data normality are presented, including visualization-based approaches using histograms and Q-Q plots as well as statistical-based approaches. Basic statistical tests are then presented, including the t-test, analysis of variance, regression modeling, chi-squared test, and Fischer’s exact test. These statistical tests are very simple, with more extensive examples and associated descriptions of statistical models in the proceeding applications-based training modules.</p>
<div id="script-preparations" class="section level4 hasAnchor">
<h4>Script Preparations<a href="finding-and-visualizing-data-trends.html#script-preparations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="cleaning-the-global-environment" class="section level5 hasAnchor">
<h5>Cleaning the global environment<a href="finding-and-visualizing-data-trends.html#cleaning-the-global-environment" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="finding-and-visualizing-data-trends.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="installing-required-r-packages" class="section level5 hasAnchor">
<h5>Installing required R packages<a href="finding-and-visualizing-data-trends.html#installing-required-r-packages" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>If you already have these packages installed, you can skip this step, or you can run the below code which checks installation status for you</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="finding-and-visualizing-data-trends.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;tidyverse&quot;</span>))</span>
<span id="cb85-2"><a href="finding-and-visualizing-data-trends.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>);</span></code></pre></div>
</div>
<div id="loading-r-packages-required-for-this-session" class="section level5 hasAnchor">
<h5>Loading R packages required for this session<a href="finding-and-visualizing-data-trends.html#loading-r-packages-required-for-this-session" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="finding-and-visualizing-data-trends.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All tidyverse packages, including dplyr and ggplot2</span></span>
<span id="cb86-2"><a href="finding-and-visualizing-data-trends.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span></code></pre></div>
</div>
<div id="set-your-working-directory-2" class="section level5 hasAnchor">
<h5>Set your working directory<a href="finding-and-visualizing-data-trends.html#set-your-working-directory-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="finding-and-visualizing-data-trends.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/filepath to where your input files are&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="importing-example-datasets-1" class="section level4 hasAnchor">
<h4>Importing example datasets<a href="finding-and-visualizing-data-trends.html#importing-example-datasets-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Then let’s read in our example dataset. Note that these data are similar to those used in the previous training module on data organization, except that demographic and chemical measurement data were previously merged, and a few additional columns of subject information/demographics were added to serve as more thorough examples of data for use in this training module.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="finding-and-visualizing-data-trends.html#cb88-1" aria-hidden="true" tabindex="-1"></a>full.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Module1_3/Module1_3_FullDemoChemData.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="viewing-example-datasets-1" class="section level4 hasAnchor">
<h4>Viewing example datasets<a href="finding-and-visualizing-data-trends.html#viewing-example-datasets-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s see what this dataset looks like:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="finding-and-visualizing-data-trends.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(full.data)</span></code></pre></div>
<pre><code>## [1] 200  15</code></pre>
<p>This dataset includes 200 rows x 15 columns</p>
<p>Let’s view the top of the first 9 columns of data in this dataframe:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="finding-and-visualizing-data-trends.html#cb91-1" aria-hidden="true" tabindex="-1"></a>full.data[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]</span></code></pre></div>
<pre><code>##    ID  BMI      BMIcat     MAge MEdu       BW GA Smoker Smoker3
## 1   1 27.7  Overweight 22.99928    3 3180.058 34      0   Never
## 2   2 26.8  Overweight 30.05142    3 3210.823 43      1   Never
## 3   3 33.2  Overweight 28.04660    3 3311.551 40      0   Never
## 4   4 30.1  Overweight 34.81796    3 3266.844 32      1   Never
## 5   5 37.4  Overweight 42.68440    3 3664.088 35      0   Never
## 6   6 33.3  Overweight 24.94960    3 3328.988 40      0   Never
## 7   7 24.8  Overweight 29.54798    3 3061.949 30      0   Never
## 8   8 16.9 Underweight 24.94954    3 3332.539 38      0 Current
## 9   9 36.9  Overweight 33.58589    3 3260.482 39      0   Never
## 10 10 21.7      Normal 39.29018    3 3141.723 35      0 Current</code></pre>
<p>These represent the subject information/demographic data, which include the following columns:</p>
<ul>
<li>ID (subject number)</li>
<li>BMI (body mass index)</li>
<li>BMIcat (BMI &lt;= 18.5 binned as “Underweight”; 18.5 &lt; BMI &lt;= 24.5 binned as “Normal”; BMI &gt; 24.5 binned as “Overweight”)</li>
<li>MAge (maternal age, years)</li>
<li>MEdu (maternal education, 1= “less than high school”; 2= “high school or some college”; 3= “college or greater”)</li>
<li>BW (body weight, grams)</li>
<li>GA (gestational age, week)</li>
<li>Smoker (0= non-smoker; 1=smoker)</li>
<li>Smoker3 (“Never”, “Former”, or “Current” smoking status)</li>
</ul>
<p>Let’s now view the remaining columns (columns 10-15) in this dataframe:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="finding-and-visualizing-data-trends.html#cb93-1" aria-hidden="true" tabindex="-1"></a>full.data[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">15</span>]</span></code></pre></div>
<pre><code>##        DWAs     DWCd     DWCr       UAs       UCd      UCr
## 1  6.426464 1.292941 51.67987 10.192695 0.7537104 42.60187
## 2  7.832384 1.798535 50.10409 11.815088 0.9789506 41.30757
## 3  7.516569 1.288461 48.74001 10.079057 0.1903262 36.47716
## 4  5.906656 2.075259 50.92745  8.719123 0.9364825 42.47987
## 5  7.181873 2.762643 55.16882  9.436559 1.4977829 47.78528
## 6  9.723429 3.054057 51.14812 11.589403 1.6645837 38.26386
## 7  6.268547 1.218410 52.08578  8.887948 0.6347667 39.45535
## 8  6.718448 1.414975 54.96740  9.304968 0.6658849 45.09987
## 9  9.074928 2.727755 55.72826 10.818153 1.6585757 42.58577
## 10 5.771691 2.410993 47.06552  8.747217 1.7354305 34.80661</code></pre>
<p>These columns represent the environmental exposure measures, including:</p>
<ul>
<li>DWAs (drinking water arsenic levels in µg/L)</li>
<li>DWCd (drinking water cadmium levels in µg/L)</li>
<li>DWCr (drinking water chromium levels in µg/L)</li>
<li>UAs (urinary arsenic levels in µg/L)</li>
<li>UCd (urinary cadmium levels in µg/L)</li>
<li>UCr (urinary chromium levels in µg/L)</li>
</ul>
<p>Now that the script is prepared and the data are uploaded, we can start running some basic statistical tests and visualizations of data trends.</p>
<!-- ## Basic Statistical Tests and Visualizations of Data Trends -->
</div>
</div>
<div id="basic-data-analysis" class="section level2 hasAnchor">
<h2>Basic Data Analysis<a href="finding-and-visualizing-data-trends.html#basic-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="visualize-and-test-data-for-normality" class="section level4 hasAnchor">
<h4>Visualize and Test Data for Normality<a href="finding-and-visualizing-data-trends.html#visualize-and-test-data-for-normality" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When selecting the appropriate statistical tests to evaluate potential trends in your data, statistical test selection often relies upon whether or not the underlying data are normally distributed. Many statistical tests and methods that are commonly implemented in exposure science, toxicology, and environmental health research rely on assumptions of normality. Thus, one of the most common statistic tests to perform at the beginning of an analysis is a <strong>test for normality</strong>.</p>
<p>There are a few ways to evaluate the normality of a dataset:</p>
<p><em>First</em>, you can visually gage whether a dataset appears to be normally distributed through plots. For example, plotting data using histograms, densities, or Q-Q plots can graphically help inform if a variable’s values appear to be normally distributed or not.</p>
<p><em>Second</em>, you can evaluate normality using statistical tests, such as the <strong>Kolmogorov-Smirnov (K-S) test</strong> and <strong>Shapiro-Wilk test</strong>. When using these tests and interpreting their results, it is important to remember that the null hypothesis is that the sample distribution is normal, and a significant p-value means the distribution is non-normal.</p>
<p>Let’s start with the first approach, based on data visualizations. Here, let’s begin with a <a href="https://en.wikipedia.org/wiki/Histogram">histogram</a> to view the distribution of BMI data, as an example.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="finding-and-visualizing-data-trends.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(full.data<span class="sc">$</span>BMI)</span></code></pre></div>
<p><img src="01-Chapter1_files/figure-html/normality-1.png" width="672" /></p>
<p>We can edit some of the parameters to improve this basic histogram visualization. For example, we can decrease the size of each bin using breaks parameter:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="finding-and-visualizing-data-trends.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(full.data<span class="sc">$</span>BMI, <span class="at">breaks=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="01-Chapter1_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Let’s also view the <a href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot">Q–Q (quantile-quantile) plot</a> using the qqnorm function</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="finding-and-visualizing-data-trends.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(full.data<span class="sc">$</span>BMI)</span>
<span id="cb97-2"><a href="finding-and-visualizing-data-trends.html#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="finding-and-visualizing-data-trends.html#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a reference line for theoretically normally distributed data</span></span>
<span id="cb97-4"><a href="finding-and-visualizing-data-trends.html#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(full.data<span class="sc">$</span>BMI) </span></code></pre></div>
<p><img src="01-Chapter1_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>From these visualizations, the BMI variable appears to be normally distributed, with data centered in the middle and spreading with a distribution on both the lower and upper sides that follow typical normal data distributions.</p>
<p>Let’s now implement the second approach, based on statistical tests for normality. Here, let’s use the <a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test">Shapiro-Wilk test</a> as an example, again looking at the BMI data. This test can be carried out simply using the shapiro.test function from the base R stats package.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="finding-and-visualizing-data-trends.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(full.data<span class="sc">$</span>BMI)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  full.data$BMI
## W = 0.99232, p-value = 0.3773</code></pre>
<p>This test resulted in a p-value of 0.9014, so we cannot reject the null hypothesis (that data are normally distributed). This means that we can assume that these data are normally distributed.</p>
</div>
<div id="two-group-visualizations-and-statistical-comparisons-using-the-t-test" class="section level4 hasAnchor">
<h4>Two-Group Visualizations and Statistical Comparisons using the T-Test<a href="finding-and-visualizing-data-trends.html#two-group-visualizations-and-statistical-comparisons-using-the-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>T-tests are commonly used to test for a significant difference between the means of two groups. In this example, we will be comparing BMI measures between two groups: smokers vs. non-smokers. We will specifically be implementing a two sample t-test (or independent samples t-test).</p>
<p>Let’s first visualize the BMI data across these two groups using boxplots, for this example:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="finding-and-visualizing-data-trends.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="at">data=</span>full.data, BMI <span class="sc">~</span> Smoker)</span></code></pre></div>
<p><img src="01-Chapter1_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>From this plot, it looks like non-smokers (labeled 0) <em>may</em> have significantly higher BMI than smokers (labeled 1), though we need statistical evaluation of these data to more thoroughly evaluate this potential data trend.</p>
<p>It is easy to peform a t-test on these data using the t.test function from the base R stats package:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="finding-and-visualizing-data-trends.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">data=</span>full.data, BMI <span class="sc">~</span> Smoker)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  BMI by Smoker
## t = 2.5372, df = 80.362, p-value = 0.01311
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  0.583061 4.823447
## sample estimates:
## mean in group 0 mean in group 1 
##        26.11176        23.40851</code></pre>
<p>From this statistical output, we can see that the overall mean BMI in group 0 (non-smokers) is 26, and the overall mean BMI in group 1 (smokers) is 23. We can also see that the resulting p-value comparison between the means of these two groups is, indeed, significant (p=0.0125), meaning that the means across these groups are significantly different (i.e., are not equal).</p>
<p>It’s also helpful to save these results into a variable within the R global environment, which then allows us to access specific output values and extract them more easily for our records. For example, we can run the following to specifically extract the resulting p-value from this test:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="finding-and-visualizing-data-trends.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making a list in the R global environment with the statistical results</span></span>
<span id="cb103-2"><a href="finding-and-visualizing-data-trends.html#cb103-2" aria-hidden="true" tabindex="-1"></a>ttest.res <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">data=</span>full.data, BMI <span class="sc">~</span> Smoker) </span>
<span id="cb103-3"><a href="finding-and-visualizing-data-trends.html#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="finding-and-visualizing-data-trends.html#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling the p-value</span></span>
<span id="cb103-5"><a href="finding-and-visualizing-data-trends.html#cb103-5" aria-hidden="true" tabindex="-1"></a>ttest.res<span class="sc">$</span>p.value </span></code></pre></div>
<pre><code>## [1] 0.01310998</code></pre>
</div>
<div id="two-group-visualizations-and-statistical-comparisons-using-an-anova" class="section level4 hasAnchor">
<h4>Two-Group Visualizations and Statistical Comparisons using an ANOVA<a href="finding-and-visualizing-data-trends.html#two-group-visualizations-and-statistical-comparisons-using-an-anova" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Analysis of Variance (ANOVA) is a statistical method that can be used to compare means across more than two groups.
To demonstrate an ANOVA test on this dataset, let’s evaluate BMI distributions across current vs. former vs. never smokers (using the ‘Smoker3’ variable from our dataset).</p>
<p>Let’s again, start by viewing these data distributions using a boxplot:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="finding-and-visualizing-data-trends.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="at">data=</span>full.data, BMI <span class="sc">~</span> Smoker3)</span></code></pre></div>
<p><img src="01-Chapter1_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>Let’s also calculate the group means using tidyverse syntax and the summarise function, as helpful example script:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="finding-and-visualizing-data-trends.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can also get group means</span></span>
<span id="cb106-2"><a href="finding-and-visualizing-data-trends.html#cb106-2" aria-hidden="true" tabindex="-1"></a>full.data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Smoker3) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(BMI))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   Smoker3 `mean(BMI)`
##   &lt;chr&gt;         &lt;dbl&gt;
## 1 Current        19.1
## 2 Former         26.5
## 3 Never          27.2</code></pre>
<p>From this cursory review of the data, it looks like the current smokers likely demonstrate significantly different BMI measures than the former and never smokers, though we need statistical tests to verify this potential trend. We also require statistical tests to evaluate potential differences (or lack of differences) between former and never smokers.</p>
<p>Let’s now run the ANOVA to compare BMI between smoking groups, using the aov function to fit an ANOVA model:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="finding-and-visualizing-data-trends.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(<span class="at">data=</span>full.data, BMI <span class="sc">~</span> Smoker3)</span></code></pre></div>
<pre><code>## Call:
##    aov(formula = BMI ~ Smoker3, data = full.data)
## 
## Terms:
##                  Smoker3 Residuals
## Sum of Squares  2046.713  6817.786
## Deg. of Freedom        2       197
## 
## Residual standard error: 5.882861
## Estimated effects may be unbalanced</code></pre>
<p>We can extract the typical ANOVA results table using either summary or anova on the resulting fitted object</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="finding-and-visualizing-data-trends.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">aov</span>(<span class="at">data=</span>full.data, BMI <span class="sc">~</span> Smoker3))</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: BMI
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Smoker3     2 2046.7 1023.36   29.57 5.888e-12 ***
## Residuals 197 6817.8   34.61                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>From this ANOVA output table, we can conclude that the group means across all three groups are not equal.</p>
</div>
</div>
<div id="regression-modeling" class="section level2 hasAnchor">
<h2>Regression Modeling<a href="finding-and-visualizing-data-trends.html#regression-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="regression-modeling-and-visualization-linear-and-logistic-regressions" class="section level4 hasAnchor">
<h4>Regression Modeling and Visualization: Linear and Logistic Regressions<a href="finding-and-visualizing-data-trends.html#regression-modeling-and-visualization-linear-and-logistic-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Regression modeling aims to find a relationship between a dependent variable (or outcome, response, y) and an independent variable (or predictor, explanatory variable, x). There are many forms of regression analysis, but here we will focus on two: linear regression and logistic regression.</p>
<p>In brief, linear regression is generally used when you have a continuous dependent variable and there is assumed to be some sort of linear relationship between the dependent and independent variables. Conversely, logistic regression is often used when the dependent variable is dichotomous (0 or 1).</p>
<p>Let’s first run through an example linear regression model.</p>
</div>
<div id="linear-regression" class="section level4 hasAnchor">
<h4>Linear Regression<a href="finding-and-visualizing-data-trends.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For this example, let’s evaluate the potential relationship between the subjects’ birthweight (BW) and BMI. Here, we will first visualize the data and a run simple correlation analysis to evaluate whether these data are generally correlated. Then, we will run a linear regression to evaluate the relationship between these variables in more detail.</p>
<p>Plotting the variables against one another using the basic ‘plot’ function to produce a scatterplot:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="finding-and-visualizing-data-trends.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data=</span>full.data, BW <span class="sc">~</span> BMI)</span></code></pre></div>
<p><img src="01-Chapter1_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>Running a basic correlation analyses between these two variables using the ‘cor’ function:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="finding-and-visualizing-data-trends.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(full.data<span class="sc">$</span>BW, full.data<span class="sc">$</span>BMI)</span></code></pre></div>
<pre><code>## [1] 0.2485164</code></pre>
<p>The provides a correlation coefficient (R) value of 0.25.</p>
<p>Let’s now use the ‘cor.test’ function to extract the correlation p-value:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="finding-and-visualizing-data-trends.html#cb115-1" aria-hidden="true" tabindex="-1"></a>cor.res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(full.data<span class="sc">$</span>BW, full.data<span class="sc">$</span>BMI)</span>
<span id="cb115-2"><a href="finding-and-visualizing-data-trends.html#cb115-2" aria-hidden="true" tabindex="-1"></a>cor.res<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.0003876464</code></pre>
<p>Checking to see that we get the same correlation coefficient (R) using this function:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="finding-and-visualizing-data-trends.html#cb117-1" aria-hidden="true" tabindex="-1"></a>cor.res<span class="sc">$</span>estimate</span></code></pre></div>
<pre><code>##       cor 
## 0.2485164</code></pre>
<p>Together, it looks like there may be a relationship between BW and BMI, based on these correlation results, demonstrating a significant p-value of 0.0004.</p>
<p>To test this further, let’s run a linear regression analysis using the ‘lm’ function, using BMI as the independent variable (X) and BW as the dependent variable (Y):</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="finding-and-visualizing-data-trends.html#cb119-1" aria-hidden="true" tabindex="-1"></a>lm.res <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>full.data, BW <span class="sc">~</span> BMI)</span>
<span id="cb119-2"><a href="finding-and-visualizing-data-trends.html#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="finding-and-visualizing-data-trends.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Viewing the results summary</span></span>
<span id="cb119-4"><a href="finding-and-visualizing-data-trends.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.res) </span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BW ~ BMI, data = full.data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -598.39 -116.72    8.11  136.54  490.11 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 3069.201     52.576   58.38  &lt; 2e-16 ***
## BMI            7.208      1.997    3.61 0.000388 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 188 on 198 degrees of freedom
## Multiple R-squared:  0.06176,    Adjusted R-squared:  0.05702 
## F-statistic: 13.03 on 1 and 198 DF,  p-value: 0.0003876</code></pre>
<p>We can see here that the relationship between BMI and BW is shown to be significant, with a p-value of 0.000411</p>
<p>We can also derive confidence intervals for the BMI estimate using:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="finding-and-visualizing-data-trends.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm.res)[<span class="st">&quot;BMI&quot;</span>,]</span></code></pre></div>
<pre><code>##     2.5 %    97.5 % 
##  3.270873 11.145740</code></pre>
<p>Notice that the r-squared (R^2) value in regression output is the squared value of the previously calculated correlation coefficient (R)</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="finding-and-visualizing-data-trends.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">summary</span>(lm.res)<span class="sc">$</span>r.squared)</span></code></pre></div>
<pre><code>## [1] 0.2485164</code></pre>
<p>In epidemiological studies, the potential influence of confounders is considered by including important covariates within the final regression model. Here, let’s include the covariates of maternal age (MAge) and gestational age (GA) as an example for running a linear regression model with covariates:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="finding-and-visualizing-data-trends.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>full.data, BW <span class="sc">~</span> BMI <span class="sc">+</span> MAge <span class="sc">+</span> GA))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BW ~ BMI + MAge + GA, data = full.data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -454.04 -111.24    5.79  116.46  488.41 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2247.995    117.946  19.060  &lt; 2e-16 ***
## BMI            6.237      1.774   3.515 0.000547 ***
## MAge           4.269      1.887   2.263 0.024752 *  
## GA            19.612      2.656   7.385 4.28e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 165.5 on 196 degrees of freedom
## Multiple R-squared:  0.2805, Adjusted R-squared:  0.2695 
## F-statistic: 25.47 on 3 and 196 DF,  p-value: 5.884e-14</code></pre>
<p>Here, we can see that BMI is still significantly associated with BW, and the included covariates are also shown to be related to BW in this model.</p>
<p>Let’s further visualize these regression modeling results by adding a regression line to the original scatterplot:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="finding-and-visualizing-data-trends.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">data=</span>full.data, BW <span class="sc">~</span> BMI)</span>
<span id="cb127-2"><a href="finding-and-visualizing-data-trends.html#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="finding-and-visualizing-data-trends.html#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a regression line to plot</span></span>
<span id="cb127-4"><a href="finding-and-visualizing-data-trends.html#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="at">data=</span>full.data, BW <span class="sc">~</span> BMI)) </span></code></pre></div>
<p><img src="01-Chapter1_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>Collectively, these results demonstrate a significant relationship between BMI and BW, both when modeling with and without covariates.</p>
</div>
<div id="logistic-regression" class="section level4 hasAnchor">
<h4>Logistic Regression<a href="finding-and-visualizing-data-trends.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To carry out a logistic regression, we need to evaluate one continuous variable (here, we select maternal education, using MEdu variable) and one dichotomous variable (here, we select smoking status, using the Smoker variable).</p>
<p>When considering these data, we may hypothesize that higher levels of education are negatively associated with smoking status. In other words,
those with higher education are less likely to smoke. Because smoking status is a dichotomous variable, we will use logistic regression to look at this relationship.</p>
<p>Let’s first visualize these data using a boxplot for the dichotomous smoker dataset:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="finding-and-visualizing-data-trends.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(MEdu <span class="sc">~</span> Smoker, <span class="at">data=</span>full.data)</span></code></pre></div>
<p><img src="01-Chapter1_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>With this visualization, it’s difficult to tell whether or not there are significant differences in maternal education based on smoking status.</p>
<p>Let’s now run the statistical analysis, using logistic regression modeling:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="finding-and-visualizing-data-trends.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use GLM (generalized linear model) and specify the family as binomial</span></span>
<span id="cb129-2"><a href="finding-and-visualizing-data-trends.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this tells GLM to run a logistic regression</span></span>
<span id="cb129-3"><a href="finding-and-visualizing-data-trends.html#cb129-3" aria-hidden="true" tabindex="-1"></a>log.res <span class="ot">=</span> <span class="fu">glm</span>(Smoker <span class="sc">~</span> MEdu, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data=</span>full.data)</span>
<span id="cb129-4"><a href="finding-and-visualizing-data-trends.html#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="finding-and-visualizing-data-trends.html#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Viewing the results</span></span>
<span id="cb129-6"><a href="finding-and-visualizing-data-trends.html#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.res) </span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Smoker ~ MEdu, family = &quot;binomial&quot;, data = full.data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.8261  -0.7052  -0.7052  -0.7052   1.7398  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  -0.7172     0.6031  -1.189    0.234
## MEdu         -0.1826     0.2305  -0.792    0.428
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 218.10  on 199  degrees of freedom
## Residual deviance: 217.49  on 198  degrees of freedom
## AIC: 221.49
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Similar to the regression modeling analysis, we can also derive confidence intervals:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="finding-and-visualizing-data-trends.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(log.res)[<span class="st">&quot;MEdu&quot;</span>,]</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##      2.5 %     97.5 % 
## -0.6262616  0.2839524</code></pre>
<p>Collectively, these results show a non-significant p-value relating maternal education to smoking status. The confidence intervals also overlap across zero. Therefore, these data do not demonstrate a significant association between maternal education and smoking status.</p>
<!-- ## Statistical Evaluations of Categorical Data  -->
</div>
</div>
<div id="categorical-data-analysis" class="section level2 hasAnchor">
<h2>Categorical Data Analysis<a href="finding-and-visualizing-data-trends.html#categorical-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="chi-squared-test-and-fishers-exact-test" class="section level4 hasAnchor">
<h4>Chi-Squared Test and Fisher’s Exact Test<a href="finding-and-visualizing-data-trends.html#chi-squared-test-and-fishers-exact-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Chi-squared test and Fisher’s exact tests are used primarily when evaluating data distributions between two categorical variables.
The difference between a Chi-squared test and the Fisher’s exact test surrounds the specific procedure being run. Basically, the <a href="https://en.wikipedia.org/wiki/Chi-squared_test">Chi-squared test</a> is an approximation and is run with larger sample sizes to determine whether there is a statistically significant difference between the expected vs. observed frequencies in one or more categories of a contingency table. The <a href="https://en.wikipedia.org/wiki/Fisher%27s_exact_test">Fisher’s exact test</a> is similar, though is an exact measure that can be run on any sample size, including smaller sample sizes.</p>
<p>For this example, we are interested in evaluating the potential relationship between two categorical variables: smoking status (using the ‘Smoker’ variable) and categorical BMI group (using the ‘BMIcat’ variable).</p>
<p>To run these categorical statistical tests, let’s first create and view a 2-way contingency table, describing the frequencies of observations across the categorical BMI and smoking groups:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="finding-and-visualizing-data-trends.html#cb134-1" aria-hidden="true" tabindex="-1"></a>ContingencyTable <span class="ot">&lt;-</span> <span class="fu">with</span>(full.data, <span class="fu">table</span>(BMIcat, Smoker))</span>
<span id="cb134-2"><a href="finding-and-visualizing-data-trends.html#cb134-2" aria-hidden="true" tabindex="-1"></a>ContingencyTable</span></code></pre></div>
<pre><code>##              Smoker
## BMIcat         0  1
##   Normal      43 14
##   Overweight  87 22
##   Underweight 23 11</code></pre>
<p>Now let’s run the Chi-squared test on this table:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="finding-and-visualizing-data-trends.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(ContingencyTable)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  ContingencyTable
## X-squared = 2.1849, df = 2, p-value = 0.3354</code></pre>
<p>This results in a p-value = 0.34, demonstrating that there is no significant relationship between BMI categories and smoking status based off this test.</p>
<p>Note that we can also run the Chi-squared test using the following code, without having to generate the contingency table:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="finding-and-visualizing-data-trends.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(full.data<span class="sc">$</span>BMI, full.data<span class="sc">$</span>Smoker)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  full.data$BMI and full.data$Smoker
## X-squared = 143.17, df = 144, p-value = 0.5039</code></pre>
<p>Or:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="finding-and-visualizing-data-trends.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(full.data, <span class="fu">chisq.test</span>(BMI, Smoker))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  BMI and Smoker
## X-squared = 143.17, df = 144, p-value = 0.5039</code></pre>
<p>Note that these all produce the same results.</p>
<p>We can also run a Fisher’s Exact Test when considering smaller cell sizes.<br />
We won’t run this here due to computing time, but here is some example code for your records:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="finding-and-visualizing-data-trends.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With small cell sizes, can use Fisher&#39;s Exact Test</span></span>
<span id="cb142-2"><a href="finding-and-visualizing-data-trends.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fisher.test(full.data$BMI, full.data$Smoker)</span></span></code></pre></div>
</div>
</div>
<div id="concluding-remarks-3" class="section level2 hasAnchor">
<h2>Concluding Remarks<a href="finding-and-visualizing-data-trends.html#concluding-remarks-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In conclusion, this training module serves as a high-level introduction to basic statistics and visualization methods. Statistical approaches described in this traiing module include tests for normality, t-test, analysis of variance, regression modeling, chi-squared test, and Fischer’s exact test. Visualization approaches include boxplots, histograms, scatterplots, and regression lines. These methods serve as an important foundation for nearly all studies carried out in environmental health research.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-organization-basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="high-dimensional-data-visualizations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TAME_Toolkit.pdf", "TAME_Toolkit.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
